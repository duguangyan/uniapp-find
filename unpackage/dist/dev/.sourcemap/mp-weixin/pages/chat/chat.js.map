{"version":3,"sources":["webpack:///E:/uniapp/find.yidapi.com.cn/pages/chat/chat.vue","webpack:///E:/uniapp/find.yidapi.com.cn/pages/chat/chat.vue?91f6","webpack:///E:/uniapp/find.yidapi.com.cn/pages/chat/chat.vue?41a1","webpack:///E:/uniapp/find.yidapi.com.cn/main.js","webpack:///E:/uniapp/find.yidapi.com.cn/pages/chat/chat.vue?3d96","webpack:///E:/uniapp/find.yidapi.com.cn/pages/chat/chat.vue?b0aa","webpack:///E:/uniapp/find.yidapi.com.cn/pages/chat/chat.vue?cff9","webpack:///E:/uniapp/find.yidapi.com.cn/pages/chat/chat.vue?3bf0","webpack:///E:/uniapp/find.yidapi.com.cn/utils/IMapi.js","webpack:///E:/uniapp/find.yidapi.com.cn/utils/math.js","webpack:///E:/uniapp/find.yidapi.com.cn/utils/md5.js"],"names":["Page","App","apiUrl","Promise","prototype","finally","callback","P","constructor","then","value","resolve","reason","MakeSign","url","Obj","newKey","Object","keys","sort","newObj","i","length","str","key","newUrl","indexOf","split","newStr","substring","replace","myRequest","params","id","st","page","reject","timestamp","Date","parse","data","sign","deviceId","platformType","versionCode","token","wx","getStorageSync","token_type","header","undefined","request","method","success","res","code","hideLoading","console","log","fromCenter","setStorageSync","showModal","title","content","confirmText","confirm","navigateTo","cancel","showToast","msg","icon","duration","fail","err","errMsg","image","complete","getUserInfoformSocket","userId","getMessageBySocket","getCacheMessage","getPhotoByIM","module","exports","chars","math","n","Math","ceil","random","md5","string","x","Array","k","AA","BB","CC","DD","a","b","c","d","S11","S12","S13","S14","S21","S22","S23","S24","S31","S32","S33","S34","S41","S42","S43","S44","Utf8Encode","ConvertToWordArray","FF","GG","HH","II","AddUnsigned","WordToHex","RotateLeft","lValue","iShiftBits","lX","lY","lX4","lY4","lX8","lY8","lResult","F","y","z","G","H","I","s","ac","lWordCount","lMessageLength","lNumberOfWords_temp1","lNumberOfWords_temp2","lNumberOfWords","lWordArray","lBytePosition","lByteCount","charCodeAt","WordToHexValue","WordToHexValue_temp","lByte","lCount","toString","substr","utftext","String","fromCharCode"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGA;AACA;AACA;AACA;AACA,qI;;AAEA;AACA,MADA,kBACA;AACA;AACA,iBADA;AAEA,oBAFA;AAGA,wBAHA;AAIA,yBAJA;AAKA,qBALA;AAMA,cANA;AAOA,YAPA;AAQA,yCARA;AASA,sBATA;AAUA,wDAVA;AAWA,mBAXA;AAYA,gBAZA;AAaA,mBAbA;AAcA,eAdA;AAeA,uCAfA;AAgBA;AACA,mBADA;AAEA,oBAFA;AAGA,mBAHA,EAhBA;;AAqBA,gBArBA;AAsBA,yCAtBA;AAuBA,mFAvBA;AAwBA,oBAxBA;AAyBA,kBAzBA;AA0BA,sBA1BA;AA2BA,kBA3BA;AA4BA,mBA5BA;AA6BA,oBA7BA;AA8BA,kBA9BA;AA+BA,uBA/BA;AAgCA,qBAhCA;AAiCA,oBAjCA;AAkCA,oBAlCA;AAmCA,sBAnCA;AAoCA,mBApCA;AAqCA,mBArCA;AAsCA,kBAtCA;;AAwCA,GA1CA;AA2CA,QA3CA,kBA2CA,OA3CA,EA2CA;AACA;AACA;;AAEA;AACA;AACA,KAFA,MAEA;AACA;AACA;AACA;AACA,+BADA;;;AAIA;AACA;AACA;AACA,kGADA;AAEA;AACA,mBADA;;;AAIA;AACA,wBADA;AAEA,+BAFA;AAGA,qBAHA;AAIA,qBAJA;AAKA,gBALA;AAMA,mBANA;AAOA,oBAPA;AAQA,oBARA;AASA,kBATA;;AAWA;;AAEA,GA7EA;AA8EA,SA9EA,qBA8EA;;AAEA,GAhFA;AAiFA,QAjFA,oBAiFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SANA,MAMA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAJA,MAIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAFA;AAGA;AACA,OA/BA,MA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SARA,MAQA;AACA;AACA;AACA;AACA;AACA,eAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAFA;;AAIA;AACA;;AAEA,eARA,MAQA;AACA;AACA;AACA,iBAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAvCA,MAuCA;AACA;AACA;AACA,2BADA;AAEA,2BAFA;AAGA,yCAHA;AAIA,yCAJA;AAKA,6BALA;AAMA,6BANA;AAOA,wBAPA;AAQA,2BARA;AASA,4BATA;AAUA,6BAVA;AAWA,0BAXA;;AAaA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAFA,EAEA,IAFA;AAGA;AACA;AACA;AACA,KAjIA;AAkIA,GArNA;AAsNA;AACA,cADA,sBACA,CADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+CADA,CACA;AACA,6CAFA,CAEA;AACA,4DAHA,CAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wCAFA,CAEA;AACA,aAHA,EAGA,IAHA;AAIA,WALA,MAKA;AACA;AACA;AACA;AACA,wCAHA,CAGA;AACA,aAJA,EAIA,IAJA;AAKA;;AAEA,SAzBA;;AA2BA;AACA,KA5CA;;AA8CA,sBA9CA,gCA8CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8BADA;AAEA,0BAFA;AAGA,uBAHA;AAIA,uBAJA;AAKA,kBALA;AAMA,qBANA;AAOA,sBAPA;AAQA,gCARA;AASA,0BATA;;AAWA;AACA;AACA,qCA3BA,CA2BA;AACA;AACA,KA3EA;;;AA8EA,eA9EA,uBA8EA,IA9EA,EA8EA,MA9EA,EA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAFA;AAGA;AACA;AACA,WAFA,MAEA;AACA;AACA;AACA,SAVA,MAUA;AACA;AACA;AACA,mCADA;AAEA,sCAFA;AAGA,+DAHA;AAIA,yCAJA;AAKA,yBALA;AAMA,mCANA;AAOA,qCAPA;AAQA,yCARA;;AAUA;AACA;AACA;;AAEA;AACA,KA9GA;AA+GA,sBA/GA,gCA+GA;AACA;AACA;AACA;AACA,sBADA;AAEA,kBAFA;AAGA,UAHA,CAGA;;AAEA,OALA;AAMA,KAxHA;AAyHA,yBAzHA,mCAyHA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,kBAFA;AAGA,UAHA,CAGA;AACA;;AAEA,OANA;AAOA,KApIA;AAqIA,aArIA,qBAqIA,CArIA,EAqIA;AACA;AACA;AACA;AACA,KAzIA;;AA2IA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BADA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BADA;AAEA,0BAFA;AAGA,4BAHA;AAIA,wBAJA;AAKA,uBALA;AAMA,kBANA;AAOA,qBAPA;AAQA,sBARA;AASA,uBATA;AAUA,oBAVA;;AAYA;AACA,qCADA;AAEA,eAFA,qBAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA,SAdA;AAeA,YAfA,kBAeA;AACA;AACA,SAjBA;;AAmBA;AACA;AACA;AACA;AACA,OAFA,EAEA,GAFA;;AAIA,KAjMA;AAkMA;AACA;AACA;AACA;AACA,gBADA;AAEA,gCAFA;AAGA,uCAHA,EAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCADA;AAEA,gCAFA;AAGA,kCAHA;AAIA,8BAJA;AAKA,8BALA;AAMA,wBANA;AAOA,2BAPA;AAQA,4BARA;AASA,6BATA;AAUA,0BAVA;;;AAaA;;AAEA;;AAEA;;AAEA;AACA,WA1BA;AA2BA,SApCA;;AAsCA,KA3OA;AA4OA;AACA;AACA,4CAFA,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBADA,EACA;AACA,mBAFA,CAEA;AAFA;AAIA,KAxPA;AAyPA;AACA;AACA;AACA;AACA;AACA,KA9PA;AA+PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAPA;AAQA;AACA;AACA;AACA,SAXA;AAYA;AACA;;AAEA,SAfA;;;AAkBA,KAtRA;AAuRA;AACA;AACA,KAzRA;AA0RA;AACA;AACA;AACA;AACA;AACA,sBADA;AAEA,wCAFA;;AAIA,KAlSA;AAmSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kFADA;;AAGA,KA5SA;AA6SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CADA;AAEA,uCAFA;;AAIA;AACA;AACA,KAzTA;AA0TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DADA;AAEA,gCAFA;AAGA,sBAHA;AAIA;AACA,iDADA;AAEA,wCAFA;AAGA,2DAHA,EAJA;;AASA,wBATA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CADA;AAEA,uBAFA,qBAEA;AACA;AACA;AACA,iBALA;AAMA,oBANA,kBAMA;AACA;AACA,iBARA;;AAUA,aAbA,MAaA;AACA;AACA;AACA,WA7BA;AA8BA,cA9BA,gBA8BA,GA9BA,EA8BA;AACA;AACA,WAhCA;AAiCA;AACA;AACA,WAnCA;;AAqCA;AACA;AACA;AACA;AACA,OAHA,EAGA,GAHA;AAIA,KAlXA;AAmXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA1XA;AA2XA;AACA;AACA;AACA;AACA;AACA;AACA,WAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,OAXA,EAWA,KAXA;AAYA;AACA,8BADA;AAEA,sBAFA;AAGA,oBAHA;;AAKA,KA9YA;AA+YA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCADA;AAEA,iBAFA,qBAEA;AACA;AACA,WAJA;AAKA,cALA,kBAKA;AACA;AACA,WAPA;;AASA;AACA,KAhaA;;AAkaA;AACA;AACA,KApaA,EAtNA,E;;;;;;;;;;;;ACtGA,uC;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,mCAAmC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,eAAe;AACf,SAAS;AACT;AACA,sBAAsB,4BAA4B;AAClD;AACA,6BAA6B,SAAS,oCAAoC,EAAE;AAC5E;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS,iBAAiB,EAAE;AACzC;AACA;AACA;AACA,iBAAiB,iCAAiC;AAClD;AACA;AACA,kCAAkC,0BAA0B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,kCAAkC,kCAAkC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;AACnD,kDAAkD;AAClD,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,UAAU;AACrE;AACA,+BAA+B;AAC/B;AACA;AACA,gDAAgD,0BAA0B;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA,uCAAuC;AACvC,2CAA2C;AAC3C,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,iCAAiC;AACjC,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC,yCAAyC;AACzC,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,4BAA4B;AACpE;AACA;AACA;AACA;AACA,wCAAwC,qCAAqC;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,iBAAiB;AACjB;AACA;AACA,kCAAkC,0BAA0B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,kCAAkC,kCAAkC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;AACnD,kDAAkD;AAClD,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,UAAU;AACrE;AACA,+BAA+B;AAC/B;AACA;AACA,gDAAgD,0BAA0B;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA,uCAAuC;AACvC,2CAA2C;AAC3C,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,iCAAiC;AACjC,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC,yCAAyC;AACzC,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,4BAA4B;AACpE;AACA;AACA;AACA;AACA,wCAAwC,qCAAqC;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,sBAAsB,+BAA+B;AACrD,wBAAwB,gCAAgC;AACxD,wBAAwB,0BAA0B;AAClD,2BAA2B,SAAS,0BAA0B,EAAE;AAChE;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,kBAAkB,2BAA2B;AAC7C,kBAAkB,uBAAuB;AACzC,oBAAoB,mCAAmC;AACvD;AACA;AACA;AACA;AACA;AACA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","file":"pages/chat/chat.js","sourcesContent":["<template>\r\n\t<view>\r\n\t\t<scroll-view upper-threshold=\"20\" :scroll-into-view=\"toView\" :scroll-top=\"scrollTop\" scroll-y=\"isScrollY\" :focus=\"mode\"\r\n\t\t enable-back-to-top=\"true\" :style=\"{ height: scroll_height + 'px' }\" @scroll=\"bindscroll\" class=\"message-list\">\r\n\t\t\t<view class='loding-img'>\r\n\t\t\t\t<image v-if=\"noData\" src='/static/images/loading.gif'></image>\r\n\t\t\t\t<view v-if=\"!noData\">没有更多数据了</view>\r\n\t\t\t</view>\r\n\t\t\t<view id=\"hideview\">\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"row\" v-for=\"(item , index) in HideData\" :key=\"index\">\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"datetime\" v-if=\"item.timeInterval && item.timeInterval != ''\">{{item.timeInterval}}</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"body\" :style=\"{'flex-flow': item.fromUserId != userId ? 'row' : 'row-reverse'}\">\r\n\t\t\t\t\t\t<view class=\"avatar-container\">\r\n\t\t\t\t\t\t\t<image class=\"avatar\" :src=\"item.fromUserId != userId ? fromUserPhoto : toUserPhoto\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<block v-if=\"item.smsType == 'TEXT'\">\r\n\t\t\t\t\t\t\t<view class=\"triangle\" :style=\"item.fromUserId == userId ? 'right: 110rpx; background: #7ECB4B' : 'left: 110rpx;'\"></view>\r\n\t\t\t\t\t\t\t<view class=\"msg-content\" :style=\"item.fromUserId == userId ? 'background: #7ECB4B;left:5rpx;' : ''\">\r\n\t\t\t\t\t\t\t\t<text class=\"msg-text\" v-if=\"item.smsType == 'TEXT'\">{{item.content}}</text>\r\n\t\t\t\t\t\t\t\t<audio style='width:100px;height:20px' v-if=\"item.smsType == 'VOICE'\" @tap=\"audioPlay\" :data-id=\"'audio_'+index\"\r\n\t\t\t\t\t\t\t\t :src=\"item.content\"></audio>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t<image class=\"picture\" v-if=\"item.smsType == 'IMAGE'\" :src=\"item.content\" mode=\"widthFix\" @tap=\"preview\"\r\n\t\t\t\t\t\t :data-src=\"item.content\" />\r\n\t\t\t\t\t\t<block v-if='item.fromUserId == userId && item.smsStatus'>\r\n\t\t\t\t\t\t\t<image v-if='item.smsStatus == 10' class='msg-img' src='/static/images/loading.gif'></image>\r\n\t\t\t\t\t\t\t<icon v-if='item.smsStatus == 20' @tap='retry' :data-key='index' class='msg-icon' type='warn' size='22'></icon>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<block v-if='item.fromUserId == userId && item.smsStatus'>\r\n\t\t\t\t\t\t<text v-if='item.smsStatus == 40' class='msg-status'>已送达</text>\r\n\t\t\t\t\t\t<text v-if='item.smsStatus == 50' class='msg-status msg-read'>已读</text>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t</view>\r\n\r\n\r\n\r\n\t\t\t<view>\r\n\t\t\t\t<view class=\"row\" v-for=\"(item, index) in EventData\" :key=\"index\" :id=\"'row_'+index\">\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"datetime\" v-if=\"item.timeInterval && item.timeInterval != ''\">{{item.timeInterval}}</view>\r\n\t\t\t\t\r\n\t\t\t\t\t<view class=\"body\" :style=\"{'flex-flow': item.fromUserId != userId ? 'row' : 'row-reverse'}\">\r\n\t\t\t\t\t\t<view class=\"avatar-container\">\r\n\t\t\t\t\t\t\t<image class=\"avatar\" :src=\"item.fromUserId != userId ? fromUserPhoto : toUserPhoto\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<block v-if=\"item.smsType == 'TEXT'\">\r\n\t\t\t\t\t\t\t<view class=\"triangle\" :style=\"item.fromUserId == userId ? 'right: 110rpx; background: #7ECB4B' : 'left: 110rpx;'\"></view>\r\n\t\t\t\t\t\t\t<view class=\"msg-content\" :style=\"item.fromUserId == userId ? 'background: #7ECB4B;left:5rpx;' : ''\">\r\n\t\t\t\t\t\t\t\t<text class=\"msg-text\" v-if=\"item.smsType == 'TEXT'\">{{item.content}}</text>\r\n\t\t\t\t\t\t\t\t<audio style='width:100px;height:20px' v-if=\"item.smsType == 'VOICE'\" @tap=\"audioPlay\" :data-id=\"'audio_'+index\"\r\n\t\t\t\t\t\t\t\t :src=\"item.content\"></audio>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t<image class=\"picture\" v-if=\"item.smsType == 'IMAGE'\" :src=\"item.content\" mode=\"widthFix\" @tap=\"preview\" :data-src=\"item.content\" />\r\n\t\t\t\t\t\t<block v-if='item.fromUserId == userId && item.smsStatus'>\r\n\t\t\t\t\t\t\t<image v-if='item.smsStatus == 10' class='msg-img' src='/static/images/loading.gif'></image>\r\n\t\t\t\t\t\t\t<icon v-if='item.smsStatus == 20' @tap='retry' :data-key='index' class='msg-icon' type='warn' size='22'></icon>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<block v-if='item.fromUserId == userId && item.smsStatus'>\r\n\t\t\t\t\t\t<text v-if='item.smsStatus == 40' class='msg-status'>已送达</text>\r\n\t\t\t\t\t\t<text v-if='item.smsStatus == 50' class='msg-status msg-read'>已读</text>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t</scroll-view>\r\n\t\t<view class=\"hud-container\" v-if=\"status != state.normal\">\r\n\t\t\t<view class=\"hud-background\"></view>\r\n\t\t\t<view class=\"hud-body\">\r\n\t\t\t\t<image src=\"./images/mic.png\" />\r\n\t\t\t\t<view class=\"tip\" :class=\"status == state.cancel ? 'warning' : ''\">{{tips[status]}}</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"height100\"></view>\r\n\t\t<view class=\"reply\">\r\n\t\t\t<!-- <image style='display:none' :src=\"'/static/images/'+mode ? 'voice.png' : 'text.png'\" class=\"voice-image\" @tap=\"switchMode\" /> -->\r\n\t\t\t<view class=\"opration-area ply\">\r\n\t\t\t<input v-if=\"mode\"  @focus=\"inputShowed\" confirm-hold=\"true\" type=\"text\" confirm-type=\"send\" @confirm=\"reply\" v-model=\"content\" />\r\n\t\t\t\t<!-- <button class=\"voice-button\" bindlongtap=\"record\" bindtouchstart=\"touchStart\" bindtouchmove=\"touchMove\" bindtouchend=\"touchEnd\" wx:else>{{tips[status]}}</button> -->\r\n\t\t\t</view>\r\n\t\t\t<image src=\"/static/images/image.png\" class=\"choose-image ply\" @tap=\"chooseImage\" />\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport api from '../../utils/api.js';\r\n\timport IMapi from '../../utils/IMapi.js';\r\n\timport util from '../../utils/util.js';\r\n\timport md5 from '../../utils/md5.js';\r\n\timport math from '../../utils/math.js';\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcontent:'',\r\n\t\t\t\tisFalse: false,\r\n\t\t\t\tinputShowed: false,\r\n\t\t\t\tisConfirmHold: true,\r\n\t\t\t\tisScrollY: true,\r\n\t\t\t\ttoId: '',\r\n\t\t\t\tsms: 0,\r\n\t\t\t\tbaseUrl: 'https://webapi.yidap.com',\r\n\t\t\t\tmessage_list: [],\r\n\t\t\t\tscroll_height: wx.getSystemInfoSync().windowHeight,\r\n\t\t\t\tpage_index: 0,\r\n\t\t\t\tmode: true,\r\n\t\t\t\tcancel: false,\r\n\t\t\t\tstatus: 0,\r\n\t\t\t\ttips: ['按住 说话', '松开 结束', '取消 发送'],\r\n\t\t\t\tstate: {\r\n\t\t\t\t\t'normal': 0,\r\n\t\t\t\t\t'pressed': 1,\r\n\t\t\t\t\t'cancel': 2\r\n\t\t\t\t},\r\n\t\t\t\ttoView: '',\r\n\t\t\t\tuserId: wx.getStorageSync('userId'),\r\n\t\t\t\tto_avatar_path: 'https://static.yidap.com/miniapp/o2o/imgs/collection@2x.png',\r\n\t\t\t\tcurrentPage: 2,\r\n\t\t\t\tpageSize: 10,\r\n\t\t\t\tscrollLoading: 0,\r\n\t\t\t\tHideData: [],\r\n\t\t\t\tEventData: [],\r\n\t\t\t\tNoMoreEvent: 0,\r\n\t\t\t\tnoData: true,\r\n\t\t\t\tfromUserPhoto: '',\r\n\t\t\t\ttoUserPhoto: '',\r\n\t\t\t\tuserInfoId: '',\r\n\t\t\t\tmaxlength: 500,\r\n\t\t\t\tmessageCache: [],\r\n\t\t\t\tprevIndex: -1,\r\n\t\t\t\ttotalSize:'',\r\n\t\t\t\tscrollTop:0,\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tlet avatar_path = uni.getStorageSync('avatar_path');\r\n\t\t\tlet userId = uni.getStorageSync('userId');\r\n\r\n\t\t\tif (options.id) {\r\n\t\t\t\tthis.$data.toId = options.id\r\n\t\t\t} else {\r\n\t\t\t\tthis.$data.toId = options.toUserId\r\n\t\t\t}\r\n\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\ttitle: options.fmUserName,\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tthis.$data.prevIndex =  options.chatListIndex ? options.chatListIndex : -1;\r\n\t\t\tthis.$data.fromUserPhoto = options.fromUserPhoto ? options.fromUserPhoto : 'https://ossyidap.oss-cn-shenzhen.aliyuncs.com/image/png/9EAFE4BFEFDDF762718332C8F1BE9F2C.png';\r\n\t\t\tthis.$data.toUserPhoto =  avatar_path ||\r\n\t\t\t\t\t'https://ossyidap.oss-cn-shenzhen.aliyuncs.com/image/png/9EAFE4BFEFDDF762718332C8F1BE9F2C.png';\r\n\t\t\tthis.$data.userInfoId =  parseInt(userId) > parseInt(this.$data.toId) ? md5.md5(this.$data.toId + userId) : md5.md5(userId +\r\n\t\t\t\t\tthis.$data.toId);\r\n\t\t\r\n\r\n\t\t\tlet message = {\r\n\t\t\t\tfromUserId: userId,\r\n\t\t\t\ttoUserId: this.$data.toId,\r\n\t\t\t\tcontent: 'page',\r\n\t\t\t\tsmsType: 'TEXT',\r\n\t\t\t\tsysType: 1,\r\n\t\t\t\tsmsStatus: 10,\r\n\t\t\t\tsmsList: false,\r\n\t\t\t\tcurrentPage: 1,\r\n\t\t\t\tpageSize: 10\r\n\t\t\t}\r\n\t\t\tthis.sendSocketMessage(JSON.stringify(message))\r\n\r\n\t\t},\r\n\t\tmounted(){\r\n\t\t\t\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tlet _this = this;\r\n\t\t\tthis.globalData.callback = function(res) {\r\n\t\t\t\tconsole.log('-->>',res);\r\n\t\t\t\tlet result = res;\r\n\t\t\t\tif (String(result.userInfoId) == '0') {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet HideData = _this.$data.HideData;\r\n\t\t\t\tlet EventData = _this.$data.EventData;\r\n\t\t\t\tlet arr = [];\r\n\t\t\t\tif (result && result.list) {\r\n\t\t\t\t\t_this.$data.totalSize = result.totalSize\r\n\t\t\t\t\tlet dataTjson = result.list;\r\n\t\t\t\t\tif (dataTjson.length > 0) {\r\n\t\t\t\t\t\tif (_this.$data.currentPage > 2) {\r\n\t\t\t\t\t\t\t_this.$data.HideData = dataTjson;\r\n\t\t\t\t\t\t\t_this.$data.noData = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tHideData = dataTjson.concat(HideData);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t_this.$data.noData = false;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (_this.$data.currentPage <= 2) {\r\n\t\t\t\t\t\t_this.$data.EventData = HideData\r\n\t\t\t\t\t\t_this.$data.toView = 'row_10';\r\n\t\t\t\t\t\t_this.scrollToBottom();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t_this.$data.HideData = dataTjson\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet n = _this.$data.totalSize - _this.$data.EventData.length - _this.$data.HideData.length;\r\n\t\t\t\t\tif (n == 0) {\r\n\t\t\t\t\t\t_this.$data.noData = false;\r\n\t\t\t\t\t\tvar query = uni.createSelectorQuery();\r\n\t\t\t\t\t\tquery.select('#hideview').boundingClientRect();\r\n\t\t\t\t\t\tquery.exec(function(res) {\r\n\t\t\t\t\t\t\t_this.$data.scrollTop = res[0].height\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 单条数据\r\n\t\t\t\t\tif (result instanceof Array) {\r\n\t\t\t\t\t\tlet pages = getCurrentPages();\r\n\t\t\t\t\t\tlet prevPage = pages[pages.length - 2];\r\n\t\t\t\t\t\tprevPage.$data.lists = result;\r\n\t\t\t\t\t\t// prevPage.setData({\r\n\t\t\t\t\t\t// \tlists: result\r\n\t\t\t\t\t\t// })\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (result.fromUserId == 0) {\r\n\t\t\t\t\t\t\tif (result.content.indexOf('消息含有敏感内容') != -1) {\r\n\t\t\t\t\t\t\t\tlet key = _this.$data.messageCache.findIndex((value, index) => {\r\n\t\t\t\t\t\t\t\t\treturn value.messageId == result.messageId\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tif (key != -1) {\r\n\t\t\t\t\t\t\t\t\tlet cache = _this.$data.messageCache[key]\r\n\t\t\t\t\t\t\t\t\t_this.$data.EventData[cache.index].smsStatus = result.smsStatus\r\n\t\t\t\t\t\t\t\t\t_this.$data.messageCache.splice(key, 1)\r\n\t\t\t\t\t\t\t\t\tclearTimeout(cache.delay);\r\n\t\t\t\t\t\t\t\t\t// _this.$data.EventData = _this.$data.EventData;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (_this.$data.messageCache.length > 0) {\r\n\t\t\t\t\t\t\t\tif (result.currentPage && result.currentPage != '') {\r\n\t\t\t\t\t\t\t\t\t_this.$data.messageCache.forEach((value, index) => {\r\n\t\t\t\t\t\t\t\t\t\t_this.$data.EventData[value.index].smsStatus = result.smsStatus\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// _this.$data.EventData = _this.$data.EventData;\r\n\t\t\t\t\t\t\t\t\t_this.$data.messageCache = [];\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tlet key = _this.$data.messageCache.findIndex((value, index) => {\r\n\t\t\t\t\t\t\t\t\t\treturn value.messageId == result.messageId\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tif (key != -1) {\r\n\t\t\t\t\t\t\t\t\t\tlet cache = _this.$data.messageCache[key]\r\n\t\t\t\t\t\t\t\t\t\t_this.$data.EventData[cache.index].smsStatus = result.smsStatus\r\n\t\t\t\t\t\t\t\t\t\tif (result.smsStatus == 50) {\r\n\t\t\t\t\t\t\t\t\t\t\t_this.$data.messageCache.splice(key, 1)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tclearTimeout(cache.delay);\r\n\t\t\t\t\t\t\t\t\t\t// _this.$data.EventData =  _this.$data.EventData;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// 通知对方我已经阅读消息\r\n\t\t\t\t\t\t\tlet message = {\r\n\t\t\t\t\t\t\t\tid: result.id,\r\n\t\t\t\t\t\t\t\tfromUserId: 0,\r\n\t\t\t\t\t\t\t\ttoUserId: result.fromUserId,\r\n\t\t\t\t\t\t\t\tmessageId: result.messageId,\r\n\t\t\t\t\t\t\t\tcontent: 'page',\r\n\t\t\t\t\t\t\t\tsmsType: 'TEXT',\r\n\t\t\t\t\t\t\t\tsysType: 1,\r\n\t\t\t\t\t\t\t\tsmsStatus: 50,\r\n\t\t\t\t\t\t\t\tsmsList: false,\r\n\t\t\t\t\t\t\t\tcurrentPage: '',\r\n\t\t\t\t\t\t\t\tpageSize: ''\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_this.sendSocketMessage(JSON.stringify(message))\r\n\t\t\t\t\t\t\tconsole.log('通知对方我已经阅读消息')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (result.userInfoId == _this.$data.userInfoId) {\r\n\t\t\t\t\t\t_this.$data.EventData.push(result);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// _this.$data.EventData = _this.$data.EventData;\r\n\t\t\t\t\t_this.scrollToBottom();\r\n\r\n\t\t\t\t\t_this.getPrevPage(true, result);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (_this.$data.currentPage <= 2) {\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t_this.bindscrolltoupper1();\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\t\t\t\t// 放开滚动置顶\r\n\t\t\t\t_this.$data.scrollLoading = 0;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tbindscroll(e) {\r\n\t\t\t\t// console.log('bindscroll', this.$data.scrollLoading);\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tif (that.$data.scrollLoading == 1) { //防止多次触发\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (!that.$data.noData) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (e.detail.scrollTop <= 10) { //触发触顶事件\r\n\t\t\t\t\t// console.log('触发顶部事件', e.detail.scrollTop)\r\n\t\t\t\t\t// 获取隐藏的view 高度\r\n\t\t\t\t\tvar query = uni.createSelectorQuery();\r\n\t\t\t\t\tquery.select('#hideview').boundingClientRect()\r\n\r\n\t\t\t\t\tquery.exec(function(res) {\r\n\t\t\t\t\t\tvar EventData = that.$data.EventData //此数据为展示的数据\r\n\t\t\t\t\t\tvar HideData = that.$data.HideData //此数据为隐藏数据\r\n\t\t\t\t\t\tEventData = HideData.concat(that.$data.EventData) // 拼接数据\r\n\t\t\t\t\t\tif (HideData == '' || !HideData) { // 判断是否隐藏数据为空\r\n\t\t\t\r\n\t\t\t\t\t\t\tthat.$data.NoMoreEvent = 1;\r\n\t\t\t\t\t\t\tthat.$data.scrollTop = 0;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treturn false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet n = that.$data.totalSize - that.$data.EventData.length - that.$data.HideData.length;\r\n\t\t\t\t\t\tif (n < 10) {\r\n\t\t\t\t\t\t\tsetTimeout(() => { // 自行选择是否定时进行加载\r\n\t\t\t\t\t\t\t\tthat.$data.EventData = EventData;\r\n\t\t\t\t\t\t\t\tthat.bindscrolltoupper1() // 请求新的数据\r\n\t\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsetTimeout(() => { // 自行选择是否定时进行加载\r\n\t\t\t\t\t\t\t\tthat.$data.EventData = EventData;\r\n\t\t\t\t\t\t\t\tthat.$data.scrollTop = res[0].height;\r\n\t\t\t\t\t\t\t\tthat.bindscrolltoupper1() // 请求新的数据\r\n\t\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tbindscrolltoupper1() {\r\n\t\t\t\tlet _this = this;\r\n\r\n\t\t\t\tif (_this.$data.scrollLoading == 1) { //防止多次触发\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\t_this.$data.scrollLoading = 1;\r\n\t\t\t\tlet currentPage = this.$data.currentPage++;\r\n\t\t\t\tlet pageSize = this.$data.pageSize;\r\n\t\t\t\tconsole.log('currentPage:' + currentPage);\r\n\r\n\t\t\t\tuni.showNavigationBarLoading();\r\n\t\t\t\tlet fromUserId = uni.getStorageSync('userId');\r\n\t\t\t\tlet toUserId = this.$data.toId;\r\n\t\t\t\tlet message = {\r\n\t\t\t\t\tfromUserId,\r\n\t\t\t\t\ttoUserId,\r\n\t\t\t\t\tcontent: 'page',\r\n\t\t\t\t\tsmsType: 'TEXT',\r\n\t\t\t\t\tsysType: 1,\r\n\t\t\t\t\tsmsStatus: 10,\r\n\t\t\t\t\tsmsList: false,\r\n\t\t\t\t\tcurrentPage,\r\n\t\t\t\t\tpageSize\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('下拉message：', message);\r\n\t\t\t\tthis.sendSocketMessage(JSON.stringify(message))\r\n\t\t\t\tuni.hideNavigationBarLoading(); //在当前页面隐藏导航条加载动画\r\n\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t},\r\n\r\n\r\n\t\t\tgetPrevPage(type, result) {\r\n\t\t\t\tif (this.$data.prevIndex != -1) {\r\n\t\t\t\t\tlet pages = getCurrentPages();\r\n\t\t\t\t\tlet prevPage = pages[pages.length - 2];\r\n\t\t\t\t\tlet lists = prevPage.$data.lists;\r\n\t\t\t\t\tif (type) {\r\n\t\t\t\t\t\tlet lists = prevPage.$data.lists;\r\n\t\t\t\t\t\tlet res = lists.findIndex((value, index) => {\r\n\t\t\t\t\t\t\treturn value.userInfoId = result.userInfoId\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tif (res != -1) {\r\n\t\t\t\t\t\t\tlists[this.$data.prevIndex].userMessage = result;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tprevPage.onSend()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet date = new Date();\r\n\t\t\t\t\t\tlet userMessage = {\r\n\t\t\t\t\t\t\tcontent: result.content,\r\n\t\t\t\t\t\t\tcreateTime: date.getTime(),\r\n\t\t\t\t\t\t\tdateTime: date.getHours() + ':' + date.getMinutes(),\r\n\t\t\t\t\t\t\tfromUserId: result.fromUserId,\r\n\t\t\t\t\t\t\tsmsStatus: 30,\r\n\t\t\t\t\t\t\tsmsType: result.smsType,\r\n\t\t\t\t\t\t\ttoUserId: result.toUserId,\r\n\t\t\t\t\t\t\tuserInfoId: result.userInfoId\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlists[this.$data.prevIndex].userMessage = userMessage\r\n\t\t\t\t\t}\r\n\t\t\t\t\tprevPage.$data.lists = lists;\r\n\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetMessageBySocket() {\r\n\t\t\t\tlet data = {}\r\n\t\t\t\tdata.userId = uni.getStorageSync(\"userId\");\r\n\t\t\t\tIMapi.getMessageBySocket({\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tdata\r\n\t\t\t\t}).then((res) => {\r\n\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetUserInfoformSocket() {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tlet data = {};\r\n\t\t\t\tdata.userId = uni.getStorageSync(\"userId\");\r\n\t\t\t\tIMapi.getUserInfoformSocket({\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tdata\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tthis.$data.to_avatar_path = res.avatar_path;\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\taudioPlay(e) {\r\n\t\t\t\tlet id = e.currentTarget.dataset.id;\r\n\t\t\t\tthis.audioCtx = uni.createAudioContext(id);\r\n\t\t\t\tthis.audioCtx.play()\r\n\t\t\t},\r\n\r\n\t\t\treply: function(e) {\r\n\t\t\t\tlet _this = this;\r\n\r\n\t\t\t\tvar content = e ? e.detail.value : this.$data.content;\r\n\t\t\t\tthis.$data.content = content;\r\n\t\t\t\tif (content == '') {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '总要写点什么吧'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar EventData = this.$data.EventData;\r\n\t\t\t\t// 发送消息\r\n\t\t\t\tlet fromUserId = uni.getStorageSync('userId');\r\n\t\t\t\tlet toUserId = this.$data.toId;\r\n\t\t\t\tlet messageId = new Date().getTime() + fromUserId + toUserId + math.math(5);\r\n\t\t\t\tmessageId = md5.md5(messageId);\r\n\t\t\t\tlet message = {\r\n\t\t\t\t\tfromUserId,\r\n\t\t\t\t\ttoUserId,\r\n\t\t\t\t\tmessageId,\r\n\t\t\t\t\tcontent,\r\n\t\t\t\t\tsmsType: 'TEXT',\r\n\t\t\t\t\tsysType: 1,\r\n\t\t\t\t\tsmsStatus: 10,\r\n\t\t\t\t\tsmsList: false,\r\n\t\t\t\t\tcurrentPage: '',\r\n\t\t\t\t\tpageSize: ''\r\n\t\t\t\t}\r\n\t\t\t\tthis.globalData.localSocket.send({\r\n\t\t\t\t\tdata: JSON.stringify(message),\r\n\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\tconsole.log('sendSocketMessage:成功了');\r\n\t\t\t\t\t\tlet len = EventData.push(message);\r\n\t\t\t\t\t\tconsole.log(EventData);\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t_this.$data.inputShowed = true;\r\n\t\t\t\t\t\t_this.$data.EventData = EventData;\r\n\t\t\t\t\t\t_this.$data.content = '';\r\n\t\t\t\t\t\t_this.timeout(messageId, len - 1)\r\n\t\t\t\t\t\t_this.getPrevPage(false, message)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t_this.sendError(len - 1)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tconsole.log('EventData -->');\r\n\t\t\t\tconsole.log(this.$data.EventData);\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\t}, 100)\r\n\r\n\t\t\t},\r\n\t\t\tchooseImage: function() {\r\n\t\t\t\t// 选择图片供上传\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 9,\r\n\t\t\t\t\tsizeType: ['compressed'],\r\n\t\t\t\t\tsourceType: ['album', 'camera'], // 可以指定来源是相册还是相机，默认二者都有\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t// 返回选定照片的本地文件路径列表，tempFilePath可以作为img标签的src属性显示图片\r\n\t\t\t\t\t\tvar tempFilePaths = res.tempFilePaths;\r\n\t\t\t\t\t\tconsole.log('选择的图片', tempFilePaths);\r\n\t\t\t\t\t\t// 遍历多图\r\n\t\t\t\t\t\ttempFilePaths.forEach((tempFilePath) => {\r\n\t\t\t\t\t\t\tlet fromUserId = wx.getStorageSync('userId');\r\n\t\t\t\t\t\t\tlet toUserId = this.$data.toId;\r\n\t\t\t\t\t\t\tlet content = tempFilePath;\r\n\t\t\t\t\t\t\tlet messageId = new Date().getTime() + fromUserId + toUserId + math.math(5);\r\n\t\t\t\t\t\t\tmessageId = md5.md5(messageId);\r\n\t\t\t\t\t\t\tlet message = {\r\n\t\t\t\t\t\t\t\tfromUserId,\r\n\t\t\t\t\t\t\t\ttoUserId,\r\n\t\t\t\t\t\t\t\tmessageId,\r\n\t\t\t\t\t\t\t\tcontent,\r\n\t\t\t\t\t\t\t\tsmsType: 'IMAGE',\r\n\t\t\t\t\t\t\t\tsysType: 1,\r\n\t\t\t\t\t\t\t\tsmsStatus: 10,\r\n\t\t\t\t\t\t\t\tsmsList: false,\r\n\t\t\t\t\t\t\t\tcurrentPage: '',\r\n\t\t\t\t\t\t\t\tpageSize: ''\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar EventData = _this.$data.EventData;\r\n\r\n\t\t\t\t\t\t\tlet len = EventData.push(message);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t_this.$data.EventData = EventData;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.upload(tempFilePath, 'image', message, len);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tpreview: function(e) {\r\n\t\t\t\t// 当前点击图片的地址加载高清大图\r\n\t\t\t\tvar src = e.currentTarget.dataset.src; //获取data-src\r\n\t\t\t\tlet index = src.indexOf('?')\r\n\t\t\t\tif (index != -1) {\r\n\t\t\t\t\tsrc = src.substring(0, index) + '?x-oss-process=style/big'\r\n\t\t\t\t}\r\n\t\t\t\t//图片预览\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\tcurrent: src, // 当前显示图片的http链接\r\n\t\t\t\t\turls: [src] // 需要预览的图片http链接列表\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tswitchMode: function() {\r\n\t\t\t\t// 切换语音与文本模式\r\n\t\t\t\t// this.setData({\r\n\t\t\t\t//   mode: !this.data.mode\r\n\t\t\t\t// });\r\n\t\t\t},\r\n\t\t\trecord: function() {\r\n\t\t\t\t// 录音事件\r\n\t\t\t\tconsole.log(\"------------------\");\r\n\t\t\t\tconsole.log(this.$data.cancel);\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\twx.startRecord({\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tconsole.log(\"------------------\");\r\n\t\t\t\t\t\tconsole.log(_this.$data.cancel)\r\n\t\t\t\t\t\tif (!_this.$data.cancel) {\r\n\t\t\t\t\t\t\t_this.upload(res.tempFilePath, 'voice');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(res) {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t//录音失败\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: function(res) {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t},\r\n\t\t\tstop: function() {\r\n\t\t\t\tuni.stopRecord();\r\n\t\t\t},\r\n\t\t\ttouchStart: function(e) {\r\n\t\t\t\t// 触摸开始\r\n\t\t\t\tvar startY = e.touches[0].clientY;\r\n\t\t\t\t// 记录初始Y值\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tstartY: startY,\r\n\t\t\t\t\tstatus: this.$data.state.pressed\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\ttouchMove: function(e) {\r\n\t\t\t\t// 触摸移动\r\n\t\t\t\tvar movedY = e.touches[0].clientY;\r\n\t\t\t\tvar distance = this.$data.startY - movedY;\r\n\t\t\t\t// console.log(distance);\r\n\t\t\t\t// 距离超过50，取消发送\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tstatus: distance > 50 ? this.$data.state.cancel : this.$data.state.pressed\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\ttouchEnd: function(e) {\r\n\t\t\t\t// 触摸结束\r\n\t\t\t\tvar endY = e.changedTouches[0].clientY;\r\n\t\t\t\tvar distance = this.$data.startY - endY;\r\n\t\t\t\t// console.log(distance);\r\n\t\t\t\t// 距离超过50，取消发送\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tcancel: distance > 50 ? true : false,\r\n\t\t\t\t\tstatus: this.$data.state.normal\r\n\t\t\t\t});\r\n\t\t\t\t// 不论如何，都结束录音\r\n\t\t\t\tthis.stop();\r\n\t\t\t},\r\n\t\t\tupload: function(tempFilePath, type, message, len) {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\t// 上传图片，返回链接地址跟id,返回进度对象\r\n\t\t\t\tif (type == 'image') {\r\n\t\t\t\t\tconst access_token = uni.getStorageSync('access_token') || uni.getStorageSync('token') || \"\";\r\n\t\t\t\t\tlet data = {};\r\n\t\t\t\t\tdata.file = '[object Object]';\r\n\t\t\t\t\tdata.type = 'big';\r\n\t\t\t\t\tlet timestamp = Date.parse(new Date());\r\n\t\t\t\t\tdata.timestamp = timestamp;\r\n\t\t\t\t\tdata.sign = util.makeSign(api.apiUrl + '/api/upload', data);\r\n\t\t\t\t\tdata.deviceId = \"wx\";\r\n\t\t\t\t\tdata.platformType = \"1\";\r\n\t\t\t\t\tdata.versionCode = '4.0';\r\n\t\t\t\t\tlet uploadTask = uni.uploadFile({\r\n\t\t\t\t\t\turl: `${api.apiUrl}/api/upload`,\r\n\t\t\t\t\t\tfilePath: tempFilePath,\r\n\t\t\t\t\t\tname: 'file',\r\n\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t'content-type': 'multipart/form-data',\r\n\t\t\t\t\t\t\t'Accept': 'application/json',\r\n\t\t\t\t\t\t\t'Authorization': `Bearer ${access_token}`\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tformData: data,\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\tvar res = JSON.parse(res.data);\r\n\t\t\t\t\t\t\tif (200 === res.code || 0 === res.code) {\r\n\t\t\t\t\t\t\t\t// 发送消息\r\n\t\t\t\t\t\t\t\tmessage.content = res.data;\r\n\t\t\t\t\t\t\t\tthis.globalData.localSocket.send({\r\n\t\t\t\t\t\t\t\t\tdata: JSON.stringify(message),\r\n\t\t\t\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t\t\t\t_this.timeout(message.messageId, len - 1)\r\n\t\t\t\t\t\t\t\t\t\t_this.getPrevPage(false, message)\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t\t\t\t\t_this.sendError(len - 1)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t_this.sendError(len - 1)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\t_this.sendError(len - 1)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t}, 300)\r\n\t\t\t},\r\n\t\t\tsendError: function(len) {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tlet error = this.$data.EventData[len];\r\n\t\t\t\tif (error) {\r\n\t\t\t\t\terror.smsStatus = 20;\r\n\t\t\t\t\t_this.$data.EventData = _this.$data.EventData;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttimeout: function(messageId, len) {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tlet delay = setTimeout(() => {\r\n\t\t\t\t\tif (_this.$data.messageCache.length > 0) {\r\n\t\t\t\t\t\tlet key = _this.$data.messageCache.findIndex((value, index) => {\r\n\t\t\t\t\t\t\treturn value.messageId == messageId\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (key != -1) {\r\n\t\t\t\t\t\t\t_this.$data.EventData[len].smsStatus = 20;\r\n\t\t\t\t\t\t\t_this.$data.EventData = _this.$data.EventData\r\n\t\t\t\t\t\t\tclearTimeout(this)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 60000);\r\n\t\t\t\t_this.$data.messageCache.push({\r\n\t\t\t\t\t'messageId': messageId,\r\n\t\t\t\t\t'delay': delay,\r\n\t\t\t\t\t'index': len\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tretry: function(e) { // 消息重试\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tlet index = e.currentTarget.dataset.key;\r\n\t\t\t\tlet message = _this.$data.EventData[index]\r\n\t\t\t\tif (message) {\r\n\t\t\t\t\tmessage.smsStatus = 10;\r\n\t\t\t\t\t_this.$data.EventData = _this.$data.EventData;\r\n\t\t\t\t\tthis.globalData.localSocket.send({\r\n\t\t\t\t\t\tdata: JSON.stringify(message),\r\n\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t_this.timeout(message.messageId, index)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t\tconsole.log('消息重试失败')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tscrollToBottom: function() {\r\n\t\t\t\tthis.$data.toView = 'row_' + (this.$data.EventData.length - 1);\r\n\t\t\t}\r\n\r\n\r\n\r\n\r\n\t\t},\r\n\t\t\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t/** 聊天窗口样式\r\n * 54px为回复框高度，js同\r\n */\r\n\t.height100{\r\n\t\t\r\n\t}\r\n\t.loding-img {\r\n\t\theight: 60rpx;\r\n\t\twidth: 100%;\r\n\t\tbackground: rgb(235, 235, 235);\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t.loding-img image {\r\n\t\twidth: 60rpx;\r\n\t\theight: 60rpx;\r\n\t}\r\n\r\n\t.loding-img view {\r\n\t\tline-height: 60rpx;\r\n\t}\r\n\r\n\t/*聊天记录*/\r\n\t.message-list {\r\n\t\t/*margin-bottom: 54px;*/\r\n\t\tbackground: rgb(235, 235, 235);\r\n\t\tpadding-bottom: 100upx;\r\n\t}\r\n\r\n\t/*单元行*/\r\n\t.row {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tmargin: 0;\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t/*日期*/\r\n\t.datetime {\r\n\t\tfont-size: 14px;\r\n\t\tmargin-bottom: 20px;\r\n\t\tcolor: #999;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t/*主体*/\r\n\t.body {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\talign-items: flex-start;\r\n\t\tjustify-content: flex-start;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\r\n\t/*头像容器*/\r\n\t.body.avatar-container {\r\n\t\twidth: 20%;\r\n\t}\r\n\r\n\t/*头像*/\r\n\t.body .avatar {\r\n\t\twidth: 80rpx;\r\n\t\theight: 80rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tmargin: 0 20rpx;\r\n\t}\r\n\r\n\t/*文本消息*/\r\n\t.body .msg-content {\r\n\t\tdisplay: inline-block;\r\n\t\tfont-size: 28rpx;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 10rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tline-height: 44rpx;\r\n\t\tposition: relative;\r\n\t\tleft: -2rpx;\r\n\t\ttop: 0;\r\n\t\tword-break: break-all;\r\n\t\tmax-width: calc(85% - 140rpx);\r\n\t}\r\n\r\n\t.body .msg-image {\r\n\t\tdisplay: inline-block;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t/* 三角箭头 */\r\n\t.body .triangle {\r\n\t\tbackground: white;\r\n\t\twidth: 20rpx;\r\n\t\theight: 20rpx;\r\n\t\tmargin-top: 30rpx;\r\n\t\ttransform: rotate(45deg);\r\n\t\tposition: absolute;\r\n\t}\r\n\r\n\t.msg-text {\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n\r\n\t.msg-status {\r\n\t\tfont-size: 10px;\r\n\t\tdisplay: block;\r\n\t\tmargin-right: 60px;\r\n\t\tcolor: #999;\r\n\t\ttext-align: right;\r\n\t}\r\n\r\n\t.msg-img {\r\n\t\twidth: 30px;\r\n\t\theight: 30px;\r\n\t\tmargin: auto 0;\r\n\t}\r\n\r\n\t.msg-icon {\r\n\t\tmargin: auto 4px;\r\n\t}\r\n\r\n\t/*图片消息*/\r\n\t.picture {\r\n\t\twidth: 35%;\r\n\t}\r\n\r\n\t.textarea {\r\n\t\tbackground-color: #fff;\r\n\t\twidth: 96%;\r\n\t\tborder-radius: 10rpx;\r\n\t\theight: 24px;\r\n\t\tpadding: 10rpx 20rpx;\r\n\t}\r\n\r\n\t/*回复框*/\r\n\t.reply {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tjustify-content: flex-start;\r\n\t\talign-items: center;\r\n\t\tposition: fixed;\r\n\t\tbottom: 0;\r\n\t\twidth: 100%;\r\n\t\theight: auto;\r\n\t\tborder-top: 1px solid rgb(215, 215, 215);\r\n\t\tbackground: rgb(245, 245, 245);\r\n\t}\r\n\r\n\t.reply .voice-image {\r\n\t\twidth: 25px;\r\n\t\theight: 25px;\r\n\t\tmargin-left: 3%;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t/*文本输入或语音录入*/\r\n\t.reply .opration-area {\r\n\t\tflex: 1;\r\n\t\tpadding: 8px;\r\n\t}\r\n\r\n\t/*回复文本框*/\r\n\t.reply input {\r\n\t\tbackground: rgb(252, 252, 252);\r\n\t\theight: 32px;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 0 16rpx;\r\n\t\tfont-size: 16px;\r\n\t}\r\n\r\n\t/*选取图片*/\r\n\t.reply .choose-image {\r\n\t\twidth: 25px;\r\n\t\theight: 25px;\r\n\t\tmargin-right: 3%;\r\n\t}\r\n\r\n\t/*按住说话button*/\r\n\t.voice-button {\r\n\t\theight: 36px;\r\n\t\tcolor: #818181;\r\n\t\tfont-size: 14px;\r\n\t\tline-height: 36px;\r\n\t}\r\n\r\n\t/*悬浮提示框*/\r\n\t.hud-container {\r\n\t\tposition: fixed;\r\n\t\twidth: 150px;\r\n\t\theight: 150px;\r\n\t\tleft: 50%;\r\n\t\ttop: 50%;\r\n\t\tmargin-left: -75px;\r\n\t\tmargin-top: -75px;\r\n\t}\r\n\r\n\t/*背景层*/\r\n\t.hud-background {\r\n\t\tposition: absolute;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground: #999;\r\n\t\topacity: .8;\r\n\t\tz-index: 11;\r\n\t\tborder-radius: 10px;\r\n\t}\r\n\r\n\t/*悬浮框主体*/\r\n\t.hud-body {\r\n\t\tposition: relative;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tz-index: 19;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t/*图标*/\r\n\t.hud-body image {\r\n\t\tmargin-top: 20px;\r\n\t\twidth: 80px;\r\n\t\theight: 80px;\r\n\t}\r\n\r\n\t/*文字*/\r\n\t.hud-body .tip {\r\n\t\tcolor: #fff;\r\n\t\ttext-align: center;\r\n\t\twidth: 90%;\r\n\t\tline-height: 34px;\r\n\t\tmargin: 0 auto;\r\n\t\tmargin-bottom: 10px;\r\n\t}\r\n\r\n\t.hud-body .warning {\r\n\t\tbackground: #cc3333;\r\n\t\tborder-radius: 5px;\r\n\t}\r\n\r\n\t::-webkit-scrollbar {\r\n\t\twidth: 6rpx;\r\n\t\theight: 6rpx;\r\n\t\tcolor: transparent;\r\n\t}\r\n\r\n\t/*定义滚动条轨道 内阴影+圆角*/\r\n\t::-webkit-scrollbar-track {\r\n\t\t-webkit-box-shadow: inset 0 0 20rpx rgba(0, 0, 0, 0);\r\n\t\tborder-radius: 20rpx;\r\n\t\tbackground-color: transparent;\r\n\t}\r\n\r\n\t/*定义滑块 内阴影+圆角*/\r\n\t::-webkit-scrollbar-thumb {\r\n\t\tborder-radius: 20rpx;\r\n\t\t-webkit-box-shadow: inset 0 0 20rpx rgba(0, 0, 0, .2);\r\n\t\tbackground-color: rgba(0, 0, 0, .2);\r\n\t}\r\n</style>\n","// extracted by mini-css-extract-plugin","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"view\",\n    [\n      _c(\n        \"scroll-view\",\n        {\n          staticClass: \"message-list\",\n          style: { height: _vm.scroll_height + \"px\" },\n          attrs: {\n            \"upper-threshold\": \"20\",\n            \"scroll-into-view\": _vm.toView,\n            \"scroll-top\": _vm.scrollTop,\n            \"scroll-y\": \"isScrollY\",\n            focus: _vm.mode,\n            \"enable-back-to-top\": \"true\",\n            eventid: \"73b8c1b7-6\"\n          },\n          on: { scroll: _vm.bindscroll }\n        },\n        [\n          _c(\"view\", { staticClass: \"loding-img\" }, [\n            _vm.noData\n              ? _c(\"image\", { attrs: { src: \"/static/images/loading.gif\" } })\n              : _vm._e(),\n            !_vm.noData ? _c(\"view\", [_vm._v(\"没有更多数据了\")]) : _vm._e()\n          ]),\n          _c(\n            \"view\",\n            { attrs: { id: \"hideview\" } },\n            _vm._l(_vm.HideData, function(item, index) {\n              return _c(\n                \"view\",\n                { key: index, staticClass: \"row\" },\n                [\n                  item.timeInterval && item.timeInterval != \"\"\n                    ? _c(\"view\", { staticClass: \"datetime\" }, [\n                        _vm._v(_vm._s(item.timeInterval))\n                      ])\n                    : _vm._e(),\n                  _c(\n                    \"view\",\n                    {\n                      staticClass: \"body\",\n                      style: {\n                        \"flex-flow\":\n                          item.fromUserId != _vm.userId ? \"row\" : \"row-reverse\"\n                      }\n                    },\n                    [\n                      _c(\"view\", { staticClass: \"avatar-container\" }, [\n                        _c(\"image\", {\n                          staticClass: \"avatar\",\n                          attrs: {\n                            src:\n                              item.fromUserId != _vm.userId\n                                ? _vm.fromUserPhoto\n                                : _vm.toUserPhoto\n                          }\n                        })\n                      ]),\n                      item.smsType == \"TEXT\"\n                        ? _c(\"block\", [\n                            _c(\"view\", {\n                              staticClass: \"triangle\",\n                              style:\n                                item.fromUserId == _vm.userId\n                                  ? \"right: 110rpx; background: #7ECB4B\"\n                                  : \"left: 110rpx;\"\n                            }),\n                            _c(\n                              \"view\",\n                              {\n                                staticClass: \"msg-content\",\n                                style:\n                                  item.fromUserId == _vm.userId\n                                    ? \"background: #7ECB4B;left:5rpx;\"\n                                    : \"\"\n                              },\n                              [\n                                item.smsType == \"TEXT\"\n                                  ? _c(\"text\", { staticClass: \"msg-text\" }, [\n                                      _vm._v(_vm._s(item.content))\n                                    ])\n                                  : _vm._e(),\n                                item.smsType == \"VOICE\"\n                                  ? _c(\"audio\", {\n                                      staticStyle: {\n                                        width: \"100px\",\n                                        height: \"20px\"\n                                      },\n                                      attrs: {\n                                        \"data-id\": \"audio_\" + index,\n                                        src: item.content,\n                                        eventid: \"73b8c1b7-0-\" + index\n                                      },\n                                      on: { tap: _vm.audioPlay }\n                                    })\n                                  : _vm._e()\n                              ],\n                              1\n                            )\n                          ])\n                        : _vm._e(),\n                      item.smsType == \"IMAGE\"\n                        ? _c(\"image\", {\n                            staticClass: \"picture\",\n                            attrs: {\n                              src: item.content,\n                              mode: \"widthFix\",\n                              \"data-src\": item.content,\n                              eventid: \"73b8c1b7-1-\" + index\n                            },\n                            on: { tap: _vm.preview }\n                          })\n                        : _vm._e(),\n                      item.fromUserId == _vm.userId && item.smsStatus\n                        ? _c(\n                            \"block\",\n                            [\n                              item.smsStatus == 10\n                                ? _c(\"image\", {\n                                    staticClass: \"msg-img\",\n                                    attrs: { src: \"/static/images/loading.gif\" }\n                                  })\n                                : _vm._e(),\n                              item.smsStatus == 20\n                                ? _c(\"icon\", {\n                                    staticClass: \"msg-icon\",\n                                    attrs: {\n                                      \"data-key\": index,\n                                      type: \"warn\",\n                                      size: \"22\",\n                                      eventid: \"73b8c1b7-2-\" + index\n                                    },\n                                    on: { tap: _vm.retry }\n                                  })\n                                : _vm._e()\n                            ],\n                            1\n                          )\n                        : _vm._e()\n                    ],\n                    1\n                  ),\n                  item.fromUserId == _vm.userId && item.smsStatus\n                    ? _c(\"block\", [\n                        item.smsStatus == 40\n                          ? _c(\"text\", { staticClass: \"msg-status\" }, [\n                              _vm._v(\"已送达\")\n                            ])\n                          : _vm._e(),\n                        item.smsStatus == 50\n                          ? _c(\"text\", { staticClass: \"msg-status msg-read\" }, [\n                              _vm._v(\"已读\")\n                            ])\n                          : _vm._e()\n                      ])\n                    : _vm._e()\n                ],\n                1\n              )\n            })\n          ),\n          _c(\n            \"view\",\n            _vm._l(_vm.EventData, function(item, index) {\n              return _c(\n                \"view\",\n                {\n                  key: index,\n                  staticClass: \"row\",\n                  attrs: { id: \"row_\" + index }\n                },\n                [\n                  item.timeInterval && item.timeInterval != \"\"\n                    ? _c(\"view\", { staticClass: \"datetime\" }, [\n                        _vm._v(_vm._s(item.timeInterval))\n                      ])\n                    : _vm._e(),\n                  _c(\n                    \"view\",\n                    {\n                      staticClass: \"body\",\n                      style: {\n                        \"flex-flow\":\n                          item.fromUserId != _vm.userId ? \"row\" : \"row-reverse\"\n                      }\n                    },\n                    [\n                      _c(\"view\", { staticClass: \"avatar-container\" }, [\n                        _c(\"image\", {\n                          staticClass: \"avatar\",\n                          attrs: {\n                            src:\n                              item.fromUserId != _vm.userId\n                                ? _vm.fromUserPhoto\n                                : _vm.toUserPhoto\n                          }\n                        })\n                      ]),\n                      item.smsType == \"TEXT\"\n                        ? _c(\"block\", [\n                            _c(\"view\", {\n                              staticClass: \"triangle\",\n                              style:\n                                item.fromUserId == _vm.userId\n                                  ? \"right: 110rpx; background: #7ECB4B\"\n                                  : \"left: 110rpx;\"\n                            }),\n                            _c(\n                              \"view\",\n                              {\n                                staticClass: \"msg-content\",\n                                style:\n                                  item.fromUserId == _vm.userId\n                                    ? \"background: #7ECB4B;left:5rpx;\"\n                                    : \"\"\n                              },\n                              [\n                                item.smsType == \"TEXT\"\n                                  ? _c(\"text\", { staticClass: \"msg-text\" }, [\n                                      _vm._v(_vm._s(item.content))\n                                    ])\n                                  : _vm._e(),\n                                item.smsType == \"VOICE\"\n                                  ? _c(\"audio\", {\n                                      staticStyle: {\n                                        width: \"100px\",\n                                        height: \"20px\"\n                                      },\n                                      attrs: {\n                                        \"data-id\": \"audio_\" + index,\n                                        src: item.content,\n                                        eventid: \"73b8c1b7-3-\" + index\n                                      },\n                                      on: { tap: _vm.audioPlay }\n                                    })\n                                  : _vm._e()\n                              ],\n                              1\n                            )\n                          ])\n                        : _vm._e(),\n                      item.smsType == \"IMAGE\"\n                        ? _c(\"image\", {\n                            staticClass: \"picture\",\n                            attrs: {\n                              src: item.content,\n                              mode: \"widthFix\",\n                              \"data-src\": item.content,\n                              eventid: \"73b8c1b7-4-\" + index\n                            },\n                            on: { tap: _vm.preview }\n                          })\n                        : _vm._e(),\n                      item.fromUserId == _vm.userId && item.smsStatus\n                        ? _c(\n                            \"block\",\n                            [\n                              item.smsStatus == 10\n                                ? _c(\"image\", {\n                                    staticClass: \"msg-img\",\n                                    attrs: { src: \"/static/images/loading.gif\" }\n                                  })\n                                : _vm._e(),\n                              item.smsStatus == 20\n                                ? _c(\"icon\", {\n                                    staticClass: \"msg-icon\",\n                                    attrs: {\n                                      \"data-key\": index,\n                                      type: \"warn\",\n                                      size: \"22\",\n                                      eventid: \"73b8c1b7-5-\" + index\n                                    },\n                                    on: { tap: _vm.retry }\n                                  })\n                                : _vm._e()\n                            ],\n                            1\n                          )\n                        : _vm._e()\n                    ],\n                    1\n                  ),\n                  item.fromUserId == _vm.userId && item.smsStatus\n                    ? _c(\"block\", [\n                        item.smsStatus == 40\n                          ? _c(\"text\", { staticClass: \"msg-status\" }, [\n                              _vm._v(\"已送达\")\n                            ])\n                          : _vm._e(),\n                        item.smsStatus == 50\n                          ? _c(\"text\", { staticClass: \"msg-status msg-read\" }, [\n                              _vm._v(\"已读\")\n                            ])\n                          : _vm._e()\n                      ])\n                    : _vm._e()\n                ],\n                1\n              )\n            })\n          )\n        ]\n      ),\n      _vm.status != _vm.state.normal\n        ? _c(\"view\", { staticClass: \"hud-container\" }, [\n            _c(\"view\", { staticClass: \"hud-background\" }),\n            _c(\"view\", { staticClass: \"hud-body\" }, [\n              _c(\"image\", { attrs: { src: \"./images/mic.png\" } }),\n              _c(\n                \"view\",\n                {\n                  staticClass: \"tip\",\n                  class: _vm.status == _vm.state.cancel ? \"warning\" : \"\"\n                },\n                [_vm._v(_vm._s(_vm.tips[_vm.status]))]\n              )\n            ])\n          ])\n        : _vm._e(),\n      _c(\"view\", { staticClass: \"height100\" }),\n      _c(\"view\", { staticClass: \"reply\" }, [\n        _c(\"view\", { staticClass: \"opration-area ply\" }, [\n          _vm.mode\n            ? _c(\"input\", {\n                directives: [\n                  {\n                    name: \"model\",\n                    rawName: \"v-model\",\n                    value: _vm.content,\n                    expression: \"content\"\n                  }\n                ],\n                attrs: {\n                  \"confirm-hold\": \"true\",\n                  type: \"text\",\n                  \"confirm-type\": \"send\",\n                  eventid: \"73b8c1b7-7\"\n                },\n                domProps: { value: _vm.content },\n                on: {\n                  focus: _vm.inputShowed,\n                  confirm: _vm.reply,\n                  input: function($event) {\n                    if ($event.target.composing) {\n                      return\n                    }\n                    _vm.content = $event.target.value\n                  }\n                }\n              })\n            : _vm._e()\n        ]),\n        _c(\"image\", {\n          staticClass: \"choose-image ply\",\n          attrs: { src: \"/static/images/image.png\", eventid: \"73b8c1b7-8\" },\n          on: { tap: _vm.chooseImage }\n        })\n      ])\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import 'uni-pages';\nimport pageFactory from 'mpvue-page-factory'\n    import App from './pages/chat/chat.vue'\n    Page(pageFactory(App))","import { render, staticRenderFns } from \"./chat.vue?vue&type=template&id=26a3dd72&scoped=true&\"\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&id=26a3dd72&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"26a3dd72\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('26a3dd72', component.options)\n    } else {\n      api.reload('26a3dd72', component.options)\n    }\n    module.hot.accept(\"./chat.vue?vue&type=template&id=26a3dd72&scoped=true&\", function () {\n      api.rerender('26a3dd72', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"E:/uniapp/find.yidapi.com.cn/pages/chat/chat.vue\"\nexport default component.exports","import mod from \"-!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--18-0!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--18-0!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=script&lang=js&\"","import mod from \"-!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-1!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\lib\\\\loader.js??ref--8-oneOf-1-4!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=style&index=0&id=26a3dd72&lang=scss&scoped=true&\"; export default mod; export * from \"-!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-1!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\lib\\\\loader.js??ref--8-oneOf-1-4!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=style&index=0&id=26a3dd72&lang=scss&scoped=true&\"","export * from \"-!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=template&id=26a3dd72&scoped=true&\"","const apiUrl = 'https://webapi.yidap.com';   // 测试\r\n//const apiUrl = 'https://apiv2.yidap.com';     // 正式\r\n//const apiUrl = 'http://localhost:9331';\r\nimport md5 from \"./md5.min.js\";\r\nPromise.prototype.finally = function (callback) {\r\n    let P = this.constructor;\r\n    return this.then(\r\n        value => P.resolve(callback()).then(() => value),\r\n        reason => P.resolve(callback()).then(() => { throw reason })\r\n    );\r\n};\r\n/*\r\n *  \r\n * @param {*} params \r\n * @param {*} url String\r\n * @param {*} data Object\r\n * @param {*} success Function\r\n * @param {*} fail Function\r\n * @param {*} complete Function\r\n */\r\n// id 类型或id   st 状态\r\n\r\n// sign签名拼接方法\r\nfunction MakeSign(url, Obj) {\r\n  let newKey = Object.keys(Obj).sort()\r\n  let newObj = {}\r\n  for (let i = 0; i < newKey.length; i++) {\r\n    newObj[newKey[i]] = Obj[newKey[i]]\r\n  }\r\n  let str = ''\r\n  for (let key in newObj) {\r\n    str += key + '=' + newObj[key] + '&'\r\n  }\r\n  let newUrl='';\r\n  if (url.indexOf('https://webapi.yidap.com')>-1){\r\n    newUrl = url.split('https://webapi.yidap.com')[1];\r\n  }else{\r\n    newUrl = url.split('https://apiv2.yidap.com')[1];\r\n  } \r\n  let newStr = newUrl + '?' + str.substring(0, str.length - 1) + 'zhong_pi_lian'\r\n  newStr = newStr.replace('sign=&', '')\r\n  return md5(newStr)\r\n}\r\n\r\nconst myRequest = function (params = {}, url , id, st, page) {\r\n\r\n    return new Promise((resolve, reject) => {\r\n      let timestamp = Date.parse(new Date());\r\n        \r\n        let data = params.data || {};\r\n        \r\n            data.timestamp = timestamp;\r\n            data.sign         = MakeSign(url, data);\r\n            data.deviceId     = \"wx\";\r\n            data.platformType =  \"2\";\r\n            data.versionCode  = '4.0';\r\n            \r\n        const token = wx.getStorageSync('token') || '';\r\n        const token_type = wx.getStorageSync('token_type') || 'Bearer';\r\n        // data.member_token = token;\r\n        let header = {'Accept':'application/json', 'Authorization': token_type+ ' ' +token };\r\n        let apiUrl = url;\r\n        if (id!=undefined){\r\n          apiUrl = url +'/'+id\r\n        }\r\n        if (st != undefined) {\r\n          apiUrl = apiUrl + '/' + st\r\n        }\r\n        if (page != undefined) {\r\n          apiUrl = apiUrl + '?page=' + page\r\n        }\r\n        wx.request({\r\n            url: apiUrl,\r\n            method: params.method || 'GET',\r\n            data,\r\n            header,\r\n          success(res) {\r\n                var res = res.data;\r\n                if (200 === res.code || 0 === res.code) {\r\n                    resolve(res);\r\n                } else {\r\n                    \r\n                    if (401 === res.code) {  \r\n                      wx.hideLoading();\r\n                      console.log('401统一处理');\r\n                      let fromCenter =  wx.getStorageSync('fromCenter');\r\n                      wx.setStorageSync('fromCenter', '0');\r\n                      if (fromCenter!=1){\r\n                        wx.showModal({\r\n                          title: '您尚未登录',\r\n                          content: '是否前往登录页面',\r\n                          confirmText: '前往',\r\n                          // confirmColor: '#c81a29',\r\n                          success: (res) => {\r\n                            if (res.confirm) {\r\n                              wx.navigateTo({\r\n                                url: '../login/login',\r\n                              })\r\n                              return false;\r\n                            } else if (res.cancel) {\r\n                              console.log('用户点击取消')\r\n                            }\r\n                          }\r\n                        })\r\n                      }\r\n                    }\r\n                  if (201 === res.code){\r\n                    wx.showToast({\r\n                      title: res.msg,\r\n                      icon:'none',\r\n                      duration: 2000\r\n                    })\r\n                  }\r\n                    reject(res);\r\n                }\r\n            },\r\n            fail(err) {\r\n                // 请求超时处理\r\n                if (err.errMsg || err.errMsg === \"request:fail timeout\") {\r\n                    wx.showToast({\r\n                        title: '网络请求超时',\r\n                        image: '../../public/images/icon/error.png',\r\n                        duration: 3000\r\n                    })\r\n                    wx.hideLoading();\r\n                }\r\n\r\n                //reject(err);\r\n\r\n            },\r\n            complete(res) {\r\n              \r\n            }\r\n        })\r\n    })\r\n};\r\n\r\n// 根据用户ID获取用户信息\r\nconst getUserInfoformSocket = (params) => myRequest(params, `${apiUrl}/app/socket/getPhoto?userId=${params.data.userId}`);\r\n\r\n// 获取聊天记录\r\nconst getMessageBySocket = (params) => myRequest(params, `${apiUrl}/app/socket/getMessage`);\r\n\r\n\r\n// 未读消息\r\nconst getCacheMessage = (params) => myRequest(params, `${apiUrl}/app/socket/getCacheMessage`);\r\n\r\n// 未读消息\r\nconst getPhotoByIM = (params) => myRequest(params, `${apiUrl}/app/socket/getPhoto`);\r\n\r\n\r\n\r\n\r\nmodule.exports = {\r\n  getPhotoByIM,\r\n  getCacheMessage,\r\n  getMessageBySocket,\r\n  getUserInfoformSocket\r\n}","var chars = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G'];\r\n\r\nfunction math(n) {\r\n  var res = \"\";\r\n  for (var i = 0; i < n; i++) {\r\n    var id = Math.ceil(Math.random() * 17);\r\n    res += chars[id];\r\n  }\r\n  return res;\r\n}\r\n\r\nmodule.exports = {\r\n  math: math\r\n}","function md5(string) {\r\n    var x = Array();\r\n    var k, AA, BB, CC, DD, a, b, c, d;\r\n    var S11 = 7, S12 = 12, S13 = 17, S14 = 22;\r\n    var S21 = 5, S22 = 9, S23 = 14, S24 = 20;\r\n    var S31 = 4, S32 = 11, S33 = 16, S34 = 23;\r\n    var S41 = 6, S42 = 10, S43 = 15, S44 = 21;\r\n    string = Utf8Encode(string);\r\n    x = ConvertToWordArray(string);\r\n    a = 0x67452301;\r\n    b = 0xEFCDAB89;\r\n    c = 0x98BADCFE;\r\n    d = 0x10325476;\r\n    for (k = 0; k < x.length; k += 16) {\r\n        AA = a;\r\n        BB = b;\r\n        CC = c;\r\n        DD = d;\r\n        a = FF(a, b, c, d, x[k + 0], S11, 0xD76AA478);\r\n        d = FF(d, a, b, c, x[k + 1], S12, 0xE8C7B756);\r\n        c = FF(c, d, a, b, x[k + 2], S13, 0x242070DB);\r\n        b = FF(b, c, d, a, x[k + 3], S14, 0xC1BDCEEE);\r\n        a = FF(a, b, c, d, x[k + 4], S11, 0xF57C0FAF);\r\n        d = FF(d, a, b, c, x[k + 5], S12, 0x4787C62A);\r\n        c = FF(c, d, a, b, x[k + 6], S13, 0xA8304613);\r\n        b = FF(b, c, d, a, x[k + 7], S14, 0xFD469501);\r\n        a = FF(a, b, c, d, x[k + 8], S11, 0x698098D8);\r\n        d = FF(d, a, b, c, x[k + 9], S12, 0x8B44F7AF);\r\n        c = FF(c, d, a, b, x[k + 10], S13, 0xFFFF5BB1);\r\n        b = FF(b, c, d, a, x[k + 11], S14, 0x895CD7BE);\r\n        a = FF(a, b, c, d, x[k + 12], S11, 0x6B901122);\r\n        d = FF(d, a, b, c, x[k + 13], S12, 0xFD987193);\r\n        c = FF(c, d, a, b, x[k + 14], S13, 0xA679438E);\r\n        b = FF(b, c, d, a, x[k + 15], S14, 0x49B40821);\r\n        a = GG(a, b, c, d, x[k + 1], S21, 0xF61E2562);\r\n        d = GG(d, a, b, c, x[k + 6], S22, 0xC040B340);\r\n        c = GG(c, d, a, b, x[k + 11], S23, 0x265E5A51);\r\n        b = GG(b, c, d, a, x[k + 0], S24, 0xE9B6C7AA);\r\n        a = GG(a, b, c, d, x[k + 5], S21, 0xD62F105D);\r\n        d = GG(d, a, b, c, x[k + 10], S22, 0x2441453);\r\n        c = GG(c, d, a, b, x[k + 15], S23, 0xD8A1E681);\r\n        b = GG(b, c, d, a, x[k + 4], S24, 0xE7D3FBC8);\r\n        a = GG(a, b, c, d, x[k + 9], S21, 0x21E1CDE6);\r\n        d = GG(d, a, b, c, x[k + 14], S22, 0xC33707D6);\r\n        c = GG(c, d, a, b, x[k + 3], S23, 0xF4D50D87);\r\n        b = GG(b, c, d, a, x[k + 8], S24, 0x455A14ED);\r\n        a = GG(a, b, c, d, x[k + 13], S21, 0xA9E3E905);\r\n        d = GG(d, a, b, c, x[k + 2], S22, 0xFCEFA3F8);\r\n        c = GG(c, d, a, b, x[k + 7], S23, 0x676F02D9);\r\n        b = GG(b, c, d, a, x[k + 12], S24, 0x8D2A4C8A);\r\n        a = HH(a, b, c, d, x[k + 5], S31, 0xFFFA3942);\r\n        d = HH(d, a, b, c, x[k + 8], S32, 0x8771F681);\r\n        c = HH(c, d, a, b, x[k + 11], S33, 0x6D9D6122);\r\n        b = HH(b, c, d, a, x[k + 14], S34, 0xFDE5380C);\r\n        a = HH(a, b, c, d, x[k + 1], S31, 0xA4BEEA44);\r\n        d = HH(d, a, b, c, x[k + 4], S32, 0x4BDECFA9);\r\n        c = HH(c, d, a, b, x[k + 7], S33, 0xF6BB4B60);\r\n        b = HH(b, c, d, a, x[k + 10], S34, 0xBEBFBC70);\r\n        a = HH(a, b, c, d, x[k + 13], S31, 0x289B7EC6);\r\n        d = HH(d, a, b, c, x[k + 0], S32, 0xEAA127FA);\r\n        c = HH(c, d, a, b, x[k + 3], S33, 0xD4EF3085);\r\n        b = HH(b, c, d, a, x[k + 6], S34, 0x4881D05);\r\n        a = HH(a, b, c, d, x[k + 9], S31, 0xD9D4D039);\r\n        d = HH(d, a, b, c, x[k + 12], S32, 0xE6DB99E5);\r\n        c = HH(c, d, a, b, x[k + 15], S33, 0x1FA27CF8);\r\n        b = HH(b, c, d, a, x[k + 2], S34, 0xC4AC5665);\r\n        a = II(a, b, c, d, x[k + 0], S41, 0xF4292244);\r\n        d = II(d, a, b, c, x[k + 7], S42, 0x432AFF97);\r\n        c = II(c, d, a, b, x[k + 14], S43, 0xAB9423A7);\r\n        b = II(b, c, d, a, x[k + 5], S44, 0xFC93A039);\r\n        a = II(a, b, c, d, x[k + 12], S41, 0x655B59C3);\r\n        d = II(d, a, b, c, x[k + 3], S42, 0x8F0CCC92);\r\n        c = II(c, d, a, b, x[k + 10], S43, 0xFFEFF47D);\r\n        b = II(b, c, d, a, x[k + 1], S44, 0x85845DD1);\r\n        a = II(a, b, c, d, x[k + 8], S41, 0x6FA87E4F);\r\n        d = II(d, a, b, c, x[k + 15], S42, 0xFE2CE6E0);\r\n        c = II(c, d, a, b, x[k + 6], S43, 0xA3014314);\r\n        b = II(b, c, d, a, x[k + 13], S44, 0x4E0811A1);\r\n        a = II(a, b, c, d, x[k + 4], S41, 0xF7537E82);\r\n        d = II(d, a, b, c, x[k + 11], S42, 0xBD3AF235);\r\n        c = II(c, d, a, b, x[k + 2], S43, 0x2AD7D2BB);\r\n        b = II(b, c, d, a, x[k + 9], S44, 0xEB86D391);\r\n        a = AddUnsigned(a, AA);\r\n        b = AddUnsigned(b, BB);\r\n        c = AddUnsigned(c, CC);\r\n        d = AddUnsigned(d, DD);\r\n    }\r\n  return WordToHex(a) + WordToHex(b) + WordToHex(c) + WordToHex(d);\r\n}\r\nfunction RotateLeft(lValue, iShiftBits) {\r\n    return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits));\r\n}\r\nfunction AddUnsigned(lX, lY) {\r\n    var lX4, lY4, lX8, lY8, lResult;\r\n    lX8 = (lX & 0x80000000);\r\n    lY8 = (lY & 0x80000000);\r\n    lX4 = (lX & 0x40000000);\r\n    lY4 = (lY & 0x40000000);\r\n    lResult = (lX & 0x3FFFFFFF) + (lY & 0x3FFFFFFF);\r\n    if (lX4 & lY4) {\r\n        return (lResult ^ 0x80000000 ^ lX8 ^ lY8);\r\n    }\r\n    if (lX4 | lY4) {\r\n        if (lResult & 0x40000000) {\r\n            return (lResult ^ 0xC0000000 ^ lX8 ^ lY8);\r\n        } else {\r\n            return (lResult ^ 0x40000000 ^ lX8 ^ lY8);\r\n        }\r\n    } else {\r\n        return (lResult ^ lX8 ^ lY8);\r\n    }\r\n}\r\nfunction F(x, y, z) {\r\n    return (x & y) | ((~x) & z);\r\n}\r\nfunction G(x, y, z) {\r\n    return (x & z) | (y & (~z));\r\n}\r\nfunction H(x, y, z) {\r\n    return (x ^ y ^ z);\r\n}\r\nfunction I(x, y, z) {\r\n    return (y ^ (x | (~z)));\r\n}\r\nfunction FF(a, b, c, d, x, s, ac) {\r\n    a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac));\r\n    return AddUnsigned(RotateLeft(a, s), b);\r\n}\r\nfunction GG(a, b, c, d, x, s, ac) {\r\n    a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac));\r\n    return AddUnsigned(RotateLeft(a, s), b);\r\n}\r\nfunction HH(a, b, c, d, x, s, ac) {\r\n    a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac));\r\n    return AddUnsigned(RotateLeft(a, s), b);\r\n}\r\nfunction II(a, b, c, d, x, s, ac) {\r\n    a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac));\r\n    return AddUnsigned(RotateLeft(a, s), b);\r\n}\r\nfunction ConvertToWordArray(string) {\r\n    var lWordCount;\r\n    var lMessageLength = string.length;\r\n    var lNumberOfWords_temp1 = lMessageLength + 8;\r\n    var lNumberOfWords_temp2 = (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64;\r\n    var lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16;\r\n    var lWordArray = Array(lNumberOfWords - 1);\r\n    var lBytePosition = 0;\r\n    var lByteCount = 0;\r\n    while (lByteCount < lMessageLength) {\r\n        lWordCount = (lByteCount - (lByteCount % 4)) / 4;\r\n        lBytePosition = (lByteCount % 4) * 8;\r\n        lWordArray[lWordCount] = (lWordArray[lWordCount] | (string.charCodeAt(lByteCount) << lBytePosition));\r\n        lByteCount++;\r\n    }\r\n    lWordCount = (lByteCount - (lByteCount % 4)) / 4;\r\n    lBytePosition = (lByteCount % 4) * 8;\r\n    lWordArray[lWordCount] = lWordArray[lWordCount] | (0x80 << lBytePosition);\r\n    lWordArray[lNumberOfWords - 2] = lMessageLength << 3;\r\n    lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;\r\n    return lWordArray;\r\n}\r\nfunction WordToHex(lValue) {\r\n    var WordToHexValue = \"\", WordToHexValue_temp = \"\", lByte, lCount;\r\n    for (lCount = 0; lCount <= 3; lCount++) {\r\n        lByte = (lValue >>> (lCount * 8)) & 255;\r\n        WordToHexValue_temp = \"0\" + lByte.toString(16);\r\n        WordToHexValue = WordToHexValue + WordToHexValue_temp.substr(WordToHexValue_temp.length - 2, 2);\r\n    }\r\n    return WordToHexValue;\r\n}\r\nfunction Utf8Encode(string) {\r\n    var utftext = \"\";\r\n    for (var n = 0; n < string.length; n++) {\r\n        var c = string.charCodeAt(n);\r\n        if (c < 128) {\r\n            utftext += String.fromCharCode(c);\r\n        } else if ((c > 127) && (c < 2048)) {\r\n            utftext += String.fromCharCode((c >> 6) | 192);\r\n            utftext += String.fromCharCode((c & 63) | 128);\r\n        } else {\r\n            utftext += String.fromCharCode((c >> 12) | 224);\r\n            utftext += String.fromCharCode(((c >> 6) & 63) | 128);\r\n            utftext += String.fromCharCode((c & 63) | 128);\r\n        }\r\n    }\r\n    return utftext;\r\n}\r\nmodule.exports = {\r\n    md5: md5\r\n}\r\n"],"sourceRoot":""}