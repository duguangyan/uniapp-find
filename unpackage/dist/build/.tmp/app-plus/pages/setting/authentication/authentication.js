(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/setting/authentication/authentication"],{3071:function(a,e,t){},"313e":function(a,e,t){"use strict";var i=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("view",{staticClass:"wx_content"},[t("view",{staticClass:"authentication"},[0==a.userType||3==a.userType?t("view",{staticClass:"nav flex"},[a._l(a.navArr,function(e,i){return t("view",{key:i,staticClass:"flex-1",attrs:{eventid:"7fb52578-0-"+i},on:{click:function(e){a.navCheck(i)}}},[t("image",{attrs:{src:a.navIndex==i?e.activeImg:e.imgUrl}}),t("view",[a._v(a._s(e.name))])])}),t("view",{staticClass:"line"})],2):a._e(),t("view",{staticClass:"input"},[1==a.navIndex?t("view",{staticClass:"li cf"},[t("view",{staticClass:"name fll"},[a._v("企业名称")]),t("view",{staticClass:"value fll cf"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.companyName,expression:"companyName"}],attrs:{type:"text",placeholder:"请输入企业名称",eventid:"7fb52578-1"},domProps:{value:a.companyName},on:{input:function(e){e.target.composing||(a.companyName=e.target.value)}}})])]):a._e(),a._l(a.arr,function(e,i){return t("view",{key:i,staticClass:"li cf"},[t("view",{staticClass:"name fll"},[a._v(a._s(e.name))]),t("view",{staticClass:"value fll cf"},[1!=a.userType&&2!=a.userType||5==i?a._e():t("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{disabled:2==a.userStatus,type:"text",placeholder:e.placeholder,eventid:"7fb52578-2-"+i},domProps:{value:e.value},on:{tap:function(e){e.stopPropagation(),a.onFocus(i)},input:function(a){a.target.composing||(e.value=a.target.value)}}}),0!=a.userType&&3!=a.userType||4==i?a._e():t("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{disabled:2==a.userStatus,type:"text",placeholder:e.placeholder,eventid:"7fb52578-3-"+i},domProps:{value:e.value},on:{tap:function(e){e.stopPropagation(),a.onFocus(i)},input:function(a){a.target.composing||(e.value=a.target.value)}}}),1!=a.userType&&2!=a.userType||5!=i?a._e():t("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{disabled:2==a.userStatus,type:"idcard",placeholder:e.placeholder,eventid:"7fb52578-4-"+i},domProps:{value:e.value},on:{tap:function(e){e.stopPropagation(),a.onFocus(i)},input:function(a){a.target.composing||(e.value=a.target.value)}}}),0!=a.userType&&3!=a.userType||4!=i||0!=a.navIndex?a._e():t("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{disabled:2==a.userStatus,type:"idcard",placeholder:e.placeholder,eventid:"7fb52578-5-"+i},domProps:{value:e.value},on:{tap:function(e){e.stopPropagation(),a.onFocus(i)},input:function(a){a.target.composing||(e.value=a.target.value)}}}),0!=a.userType&&3!=a.userType||4!=i||1!=a.navIndex?a._e():t("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{disabled:2==a.userStatus,type:"text",placeholder:e.placeholder,eventid:"7fb52578-6-"+i},domProps:{value:e.value},on:{tap:function(e){e.stopPropagation(),a.onFocus(i)},input:function(a){a.target.composing||(e.value=a.target.value)}}}),1!=a.userType&&2!=a.userType||2!=i||1==a.userStatus?a._e():t("view",{staticClass:"VerificationCode flr",attrs:{eventid:"7fb52578-7-"+i},on:{click:function(e){e.stopPropagation(),a.getVerificationCode(e)}}},[a._v(a._s(a.VerificationCodeText))])])])})],2),t("view",a._l(a.ngImgTextArr,function(e,i){return(0==a.navIndex?i<2:i>=2)?t("view",{key:i,staticClass:"image"},[t("image",{attrs:{src:e.img,eventid:"7fb52578-8-"+i},on:{click:function(e){a.checkImg(i)}}}),""==a.bgImg[i]?t("view",{staticClass:"bgszie",attrs:{eventid:"7fb52578-9-"+i},on:{click:function(e){a.checkImg(i)}}},[a._v("+")]):a._e(),t("view",{staticClass:"text"},[a._v(a._s(e.text))])]):a._e()})),0!=a.userStatus?t("view",{staticClass:"info text-red cf"},[t("view",{staticClass:"fll"},[a._v(a._s(a.status_label||""))]),t("view",{staticClass:"flr mgr-20"},[a._v(a._s(a.remark||""))])]):a._e(),0==a.userStatus?t("view",{staticClass:"btn-warp"},[t("view",{staticClass:"btn",attrs:{eventid:"7fb52578-10"},on:{click:a.save}},[a._v("提交")])]):a._e(),3==a.userStatus||1==a.userStatus?t("view",{staticClass:"btn-warp"},[t("view",{staticClass:"btn",attrs:{eventid:"7fb52578-11"},on:{click:a.save}},[a._v("重新提交")])]):a._e()]),a.showCon?t("view",{staticClass:"modal-mask",attrs:{eventid:"7fb52578-14"},on:{click:a.changeModalCancel}},[t("view",{staticClass:"modal-dialog"},[t("view",{staticClass:"modal-title"},[a._v("温馨提示")]),t("view",{staticClass:"modal-content"},[a._v("获取定位失败，请前往设置打开定位权限")]),t("view",{staticClass:"modal-footer"},[t("view",{staticClass:"btn-cancel",attrs:{eventid:"7fb52578-12"},on:{click:a.changeModalCancel}},[a._v("取消")]),t("button",{staticClass:"btn-confirm button-on-view",staticStyle:{padding:"0rpx"},attrs:{"open-type":"openSetting",eventid:"7fb52578-13"},on:{click:a.changeModalCancel}},[a._v("设置")])],1)])]):a._e()])},s=[];t.d(e,"a",function(){return i}),t.d(e,"b",function(){return s})},4413:function(a,e,t){"use strict";t.r(e);var i=t("82ab"),s=t.n(i);for(var r in i)"default"!==r&&function(a){t.d(e,a,function(){return i[a]})}(r);e["default"]=s.a},"6ebc":function(a,e,t){"use strict";var i=t("3071"),s=t.n(i);s.a},"6f64":function(a,e,t){"use strict";t("a3d9");var i=r(t("b0ce")),s=r(t("fefa"));function r(a){return a&&a.__esModule?a:{default:a}}Page((0,i.default)(s.default))},"82ab":function(a,e,t){"use strict";(function(a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(t("e378")),s=r(t("0089"));function r(a){return a&&a.__esModule?a:{default:a}}var n={data:function(){return{title:"用户认证",VerificationCodeText:"获取验证码",code_id:"",id:"",companyName:"",userType:0,userStatus:0,status_label:"",remark:"",showCon:!1,navArr:[{name:"个人用户",imgUrl:"https://static.yidap.com/miniapp/o2o/imgs/ic_certification_personl_no_select.png",activeImg:"https://static.yidap.com/miniapp/o2o/imgs/ic_certification_personl_select.png"},{name:"企业用户",imgUrl:"https://static.yidap.com/miniapp/o2o/imgs/ic_certification_company_no_select.png",activeImg:"https://static.yidap.com/miniapp/o2o/imgs/ic_certification_company_select.png"}],navIndex:0,bgImg:["","",""],arr:[{name:"姓名:",value:"",placeholder:"请输入您的姓名"},{name:"联系电话:",value:"",placeholder:"请输入您的手机"},{name:"验证码:",value:"",placeholder:"请输入验证码"},{name:"详细地址:",value:"",placeholder:"请选择地区"},{name:"门牌号:",value:"",placeholder:"街道、楼牌等"},{name:"身份证号码:",value:"",placeholder:"请输入您的身份证号码"}],ngImgTextArr:[{text:"请上传身份证正面(信息页)",img:"https://static.yidap.com/miniapp/o2o/imgs/ic_certifcation_card_back.png"},{text:"请上传身份证反面(国徽页)",img:"https://static.yidap.com/miniapp/o2o/imgs/ic_certifcation_card_back.png"},{text:"请上传营业执照正面",img:"https://static.yidap.com/miniapp/o2o/imgs/ic_certifcation_card_back.png"}]}},onLoad:function(e){var t=this;if(this.$data.userType=a.getStorageSync("userType"),1==this.$data.userType||2==this.$data.userType)return!1;s.default.auditApply({}).then(function(a){if(200==a.code||0==a.code){t.$data.userStatus=a.data.status;var e=a.data;if(1==t.$data.userType||2==t.$data.userType?1==t.$data.userStatus?t.$data.arr=[{name:"姓名:",value:"",placeholder:"请输入您的姓名"},{name:"联系电话:",value:"",placeholder:"请输入您的手机"},{name:"详细地址:",value:"",placeholder:"请选择地区"},{name:"门牌号:",value:"",placeholder:"街道、楼牌等"},{name:"身份证号码:",value:"",placeholder:"请输入您的身份证号码"}]:t.$data.arr=[{name:"姓名:",value:"",placeholder:"请输入您的姓名"},{name:"联系电话:",value:"",placeholder:"请输入您的手机"},{name:"验证码:",value:"",placeholder:"请输入验证码"},{name:"详细地址:",value:"",placeholder:"请选择地区"},{name:"门牌号:",value:"",placeholder:"街道、楼牌等"},{name:"身份证号码:",value:"",placeholder:"请输入您的身份证号码"}]:1==e.type?t.$data.arr=[{name:"姓名:",value:"",placeholder:"请输入您的姓名"},{name:"联系电话:",value:"",placeholder:"请输入您的手机"},{name:"详细地址:",value:"",placeholder:"请选择地区"},{name:"门牌号:",value:"",placeholder:"街道、楼牌等"},{name:"身份证号码:",value:"",placeholder:"请输入您的身份证号码"}]:t.$data.arr=[{name:"企业法人:",value:"",placeholder:"请输入企业法人"},{name:"法人电话:",value:"",placeholder:"请输入您的企业法人电话"},{name:"详细地址:",value:"",placeholder:"请选择地区"},{name:"门牌号:",value:"",placeholder:"街道、楼牌等"},{name:"营业执照编号:",value:"",placeholder:"请输入您的营业执照编号"}],a.data.status>0){t.$data.userAuthentication=a.data;var i=a.data;i.id&&(t.$data.id=i.id),t.$data.status_label=i.status_label,t.$data.remark=i.remark,t.$data.navIndex=i.type-1,1==t.$data.navIndex&&(t.$data.companyName=i.company),t.$data.arr[0].value=i.consignee,t.$data.arr[1].value=i.mobile,t.$data.arr[2].value=i.address.split(",")[0]||"",t.$data.arr[3].value=i.address.split(",")[1]||"",2==t.$data.userType||3==t.$data.userType?(t.$data.arr[4].value="",t.$data.arr[5].value=i.id_card_no):t.$data.arr[4].value=i.id_card_no,0!=t.$data.userStatus&&(1==i.type?(t.$data.ngImgTextArr[0].img=i.id_card_front,t.$data.ngImgTextArr[1].img=i.id_card_back,t.$data.bgImg[0]=i.id_card_front,t.$data.bgImg[1]=i.id_card_back):(t.$data.ngImgTextArr[2].img=i.id_card_front,t.$data.bgImg[2]=i.id_card_front))}}})},onShow:function(){0==this.$data.userType||3==this.$data.userType?a.setNavigationBarTitle({title:"用户认证"}):1==this.$data.userType?a.setNavigationBarTitle({title:"认证找料员"}):2==this.$data.userType&&a.setNavigationBarTitle({title:"认证配送员"})},methods:{getVerificationCode:function(){var a=this;if(""==this.$data.arr[1].value)return i.default.successTips("请填写手机号码"),!1;s.default.regSMS({method:"POST",data:{mobile:this.$data.arr[1].value}}).then(function(e){200!=e.code&&0!=e.code||(a.$data.code_id=e.data.id,a.$data.VerificationCodeText="重新发送")}).catch(function(a){i.default.errorTips(a.msg||a.message)})},changeModalCancel:function(){this.$data.showCon=!1},onFocus:function(e){if(2==this.$data.userStatus)return!1;console.log(e);var t=this,s=a.getStorageSync("userType");0==s||3==s?2==e&&a.chooseLocation({success:function(a){console.log("位置名称："+a.name),console.log("详细地址："+a.address),console.log("纬度："+a.latitude),console.log("经度："+a.longitude),0==t.$data.userType||3==t.$data.userType?(t.$data.arr[2].value=a.address,t.$data.arr[3].value=a.name):(t.$data.arr[3].value=a.address,t.$data.arr[4].value=a.name)},fail:function(e){i.default.errorTips("获取地图定位失败："+e.errMsg),console.log(e),a.getSetting({success:function(a){a.authSetting["scope.userLocation"]||(t.$data.showCon=!0)}})}}):3==e&&a.chooseLocation({success:function(a){console.log("位置名称："+a.name),console.log("详细地址："+a.address),console.log("纬度："+a.latitude),console.log("经度："+a.longitude),0==t.$data.userType||3==t.$data.userType?(t.$data.arr[2].value=a.address,t.$data.arr[3].value=a.name):(t.$data.arr[3].value=a.address,t.$data.arr[4].value=a.name)},fail:function(e){i.default.errorTips("获取地图定位失败："+e.errMsg),console.log(e),a.getSetting({success:function(a){a.authSetting["scope.userLocation"]||(t.$data.showCon=!0)}})}})},navCheck:function(a){if(2==this.$data.userStatus)return!1;this.$data.navIndex=a,0==a?(this.$data.arr[0].name="姓名:",this.$data.arr[1].name="联系电话:",this.$data.arr[4].name="身份证号码:",this.$data.arr[0].placeholder="请输入您的姓名",this.$data.arr[1].placeholder="请输入您的联系电话",this.$data.arr[4].placeholder="请输入您的身份证号码"):(this.$data.arr[0].name="企业法人:",this.$data.arr[1].name="法人电话:",this.$data.arr[4].name="营业执照编号:",this.$data.arr[0].placeholder="请输入您的企业法人",this.$data.arr[1].placeholder="请输入您的企业法人电话",this.$data.arr[4].placeholder="请输入您的营业执照编号")},checkImg:function(e){if(2==this.$data.userStatus)return!1;var t=this;a.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(a){var r=wx.getStorageSync("access_token")||"",n={file:"[object Object]",type:"big"},o=Date.parse(new Date);n.timestamp=o,n.sign=i.default.makeSign(s.default.apiUrl+"/api/upload",n),n.deviceId="wx",n.platformType="2",n.versionCode="4.0";wx.uploadFile({url:"".concat(s.default.apiUrl,"/api/upload"),filePath:a.tempFilePaths[0],name:"file",header:{"content-type":"multipart/form-data",Accept:"application/json",Authorization:"Bearer ".concat(r)},formData:n,success:function(a){console.log("图片上传"),console.log(a);var s=JSON.parse(a.data);if(200===s.code||0===s.code){var r=JSON.parse(a.data).data;t.$data.ngImgTextArr[e].img=r,t.$data.bgImg[e]=r,i.default.successTips("图片上传成功")}else i.default.errorTips("上传错误")},fail:function(a){console.log(a)},complete:function(){}})}})},save:function(){var e=this;if(!i.default.vailPhone(this.$data.arr[1].value))return i.default.errorTips("请输入正确的手机号"),!1;if(0==this.$data.navIndex){if(""==this.$data.bgImg[0]||""==this.$data.bgImg[1]){if(""==this.$data.bgImg[0])return i.default.errorTips("请上传身份证正面照"),!1;if(""==this.$data.bgImg[1])return i.default.errorTips("请上传身份证背面照"),!1}}else if(""==this.$data.bgImg[2])return i.default.errorTips("请上传营业执照"),!1;var t="";if(1==this.$data.userType||2==this.$data.userType){if(""==this.$data.code_id)return i.default.errorTips("请输入验证码"),!1;t={from:1,type:this.$data.navIndex+1,consignee:this.$data.arr[0].value,mobile:this.$data.arr[1].value,address:e.$data.arr[3].value+","+e.$data.arr[4].value,id_card_no:this.$data.arr[5].value,id_card_back:this.$data.bgImg[1],id_card_front:this.$data.bgImg[0]}}else t={from:1,type:this.$data.navIndex+1,consignee:this.$data.arr[0].value,mobile:this.$data.arr[1].value,address:e.$data.arr[2].value+","+e.$data.arr[3].value,id_card_no:this.$data.arr[4].value,id_card_back:this.$data.bgImg[1],id_card_front:this.$data.bgImg[0]},1==this.$data.navIndex&&(t.company=this.$data.companyName,t.id_card_front=this.$data.bgImg[2]);1==e.$data.navIndex&&(t.id_card_front=this.$data.bgImg[2]),""!=this.$data.id&&(t.id=this.$data.id),0==this.$data.userType||3==this.$data.userType?s.default.auditApply({method:"POST",data:t}).then(function(e){200==e.code||0==e.code?(i.default.successTips("提交审核成功"),setTimeout(function(){a.navigateBack({delta:1})},1e3)):i.default.errorTips(e.msg)}).catch(function(a){i.default.errorTips(a.msg||a.message)}):1==this.$data.userType?(t.code=this.$data.arr[2].value,t.id=this.$data.code_id,t.type=1,s.default.staffAudit({method:"POST",data:t}).then(function(e){200==e.code||0==e.code?(i.default.successTips("提交审核成功"),setTimeout(function(){a.reLaunch({url:"../../index/index"})},1e3)):1==e.code?(i.default.successTips(e.msg),a.setStorageSync("isExamine1",1),setTimeout(function(){a.reLaunch({url:"../../index/index"})},1e3)):i.default.successTips(e.msg)}).catch(function(e){i.default.errorTips(e.msg||e.message),1==e.code&&(a.setStorageSync("isExamine1",1),setTimeout(function(){a.reLaunch({url:"../../index/index"})},1e3))})):2==this.$data.userType&&(t.code=this.$data.arr[2].value,t.id=this.$data.code_id,t.type=2,s.default.staffAudit({method:"POST",data:t}).then(function(e){200==e.code||0==e.code?(i.default.successTips("提交审核成功"),setTimeout(function(){a.reLaunch({url:"../../index/index"})},1e3)):1==e.code?(a.setStorageSync("isExamine1",1),setTimeout(function(){a.reLaunch({url:"../../index/index"})},1e3)):i.default.errorTips(e.msg)}).catch(function(e){i.default.errorTips(e.msg||e.message),a.setStorageSync("isExamine2",1),setTimeout(function(){a.reLaunch({url:"../../index/index"})},1e3)}))}}};e.default=n}).call(this,t("6e42")["default"])},fefa:function(a,e,t){"use strict";t.r(e);var i=t("313e"),s=t("4413");for(var r in s)"default"!==r&&function(a){t.d(e,a,function(){return s[a]})}(r);t("6ebc");var n=t("2877"),o=Object(n["a"])(s["default"],i["a"],i["b"],!1,null,"21756233",null);e["default"]=o.exports}},[["6f64","common/runtime","common/vendor"]]]);