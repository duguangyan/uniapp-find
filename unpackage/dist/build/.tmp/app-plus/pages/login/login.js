(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"0515":function(t,e,a){"use strict";a("a3d9");var s=i(a("b0ce")),o=i(a("ef1d"));function i(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(o.default))},"0ba6":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(a("15b0")),o=n(a("e378")),i=n(a("0089"));n(a("d4cf"));function n(t){return t&&t.__esModule?t:{default:t}}var c={data:function(){return{title:"登录",navText:["验证码登录","密码登录"],phone:"",code:"",passworld:"",isPhone:!1,isCode:!1,isPassworld:!1,isLogin:!1,isCodeActive:!1,codeText:"获取验证码",from:0,code_id:"",userType:0}},components:{wxTitle:s.default},computed:{navIndex:function(){return this.$store.state.fromRest}},onLoad:function(t){t.from&&(this.$data.from=t.from)},onShow:function(){this.$data.userType=t.getStorageSync("userType")},methods:{showNotes:function(){t.navigateTo({url:"../protocol/protocol"})},goBtn:function(e){1==e?t.reLaunch({url:"../index/index?menuFrom=1&authentication=1"}):2==e&&t.reLaunch({url:"../index/index?menuFrom=2&authentication=1"})},goblack:function(){t.navigateBack({delta:1})},checkNav:function(t){this.$store.commit("changeReset",{number:t}),this.judgeIsSelect()},judgeIsSelect:function(){0==this.$store.state.fromRest?o.default.vailPhone(this.$data.phone)&&""!=this.$data.code?this.$data.isLogin=!0:this.$data.isLogin=!1:1==this.$store.state.fromRest&&(o.default.vailPhone(this.$data.phone)&&""!=this.$data.passworld?this.$data.isLogin=!0:this.$data.isLogin=!1)},clickPhone:function(t){console.log(this.$data.phone),console.log(o.default.vailPhone(this.$data.phone)),this.$data.phone=t.target.value,""!=this.$data.phone?this.$data.isPhone=!0:this.$data.isPhone=!1,o.default.vailPhone(this.$data.phone)?this.$data.isCodeActive=!0:this.$data.isCodeActive=!1,this.judgeIsSelect()},clearPhone:function(){this.$data.phone="",this.$data.isLogin=!1,this.$data.isCodeActive=!1,this.judgeIsSelect(),this.$data.isPhone=!1,console.log(this.$data.phone)},clickCode:function(){""!=this.$data.code?this.$data.isCode=!0:this.$data.isCode=!1,this.judgeIsSelect()},clearCode:function(){this.$data.code="",this.$data.isLogin=!1,this.$data.isCode=!1},clickPassworld:function(){""!=this.$data.passworld?this.$data.isPassworld=!0:this.$data.isPassworld=!1,this.judgeIsSelect()},clearPassworld:function(){this.$data.passworld="",this.$data.isLogin=!1,this.$data.isPassworld=!1},generateCode:function(){var t=this;this.$data.isCodeActive&&i.default.generateCode({method:"POST",data:{mobile:this.$data.phone,type:2}}).then(function(e){0==e.code||200==e.code?(o.default.successTips("短信发送成功"),t.$data.code_id=e.data.id,t.$data.codeText="重新获取"):o.default.errorTips(e.msg)}).catch(function(t){o.default.errorTips(t.msg||t.message)})},doLogin:function(){var e=this;console.log("order"==t.getStorageSync("page")),this.$data.isLogin&&(0==this.$store.state.fromRest?i.default.loginByValidateCode({method:"POST",data:{mobile:this.$data.phone,code:this.$data.code,id:this.$data.code_id,invite_code:t.getStorageSync("invite_code")}}).then(function(a){if(0==a.code||200==a.code){console.log("login:"+a);var s=a;t.removeStorageSync("invite_code"),t.setStorageSync("token",s.data.token),t.setStorageSync("userId",s.data.id),t.setStorageSync("access_token",s.data.access_token),t.setStorageSync("avatarPath",s.data.avatar_path),t.setStorageSync("user_name",s.data.user_name),t.setStorageSync("nick_name",s.data.nick_name),e.$store.commit("updateNickName",s.data.nick_name),e.$store.commit("updateAvatarPath",s.data.avatar_path),i.default.getUserInfo().then(function(t){s.data.name=name}),t.setStorageSync("userInfo",s.data),e.$store.commit("setToken",{token:s.data.token}),e.$store.commit("setUserInfo",{userInfo:s.data}),e.$eventHub.$emit("doUserInfo",s.data),e.$eventHub.$emit("order","order"),t.reLaunch({url:"../index/index?menuFrom="+e.$data.from})}else o.default.errorTips(a.msg)}).catch(function(t){o.default.errorTips(t.msg)}):i.default.login({method:"POST",data:{mobile:this.$data.phone,password:this.$data.passworld,invite_code:t.getStorageSync("invite_code")}}).then(function(a){if(0==a.code||200==a.code){var s=a;t.removeStorageSync("invite_code"),t.setStorageSync("token",s.data.token),t.setStorageSync("userId",s.data.id),t.setStorageSync("access_token",s.data.access_token),t.setStorageSync("avatarPath",s.data.avatar_path),t.setStorageSync("user_name",s.data.user_name),t.setStorageSync("nick_name",s.data.nick_name),e.$store.commit("updateNickName",s.data.nick_name),e.$store.commit("updateAvatarPath",s.data.avatar_path),i.default.getUserInfo().then(function(t){s.data.name=t.data.name}),t.setStorageSync("userInfo",s.data),e.$store.commit("setToken",{token:s.data.token}),e.$store.commit("setUserInfo",{userInfo:s.data}),e.$eventHub.$emit("doUserInfo",a.data),e.$eventHub.$emit("order","order"),t.reLaunch({url:"../index/index?menuFrom="+e.$data.from})}else o.default.errorTips(a.msg)}).catch(function(t){o.default.errorTips(t.msg)}))},reset:function(){t.navigateTo({url:"/pages/resetPassworld/resetPassworld"})}}};e.default=c}).call(this,a("6e42")["default"])},"53f2":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"wx_content fs24"},[a("view",{staticClass:"nav flex fw6"},t._l(t.navText,function(e,s){return a("view",{key:s,staticClass:"flex-1 text-center",class:{active:t.navIndex==s},attrs:{eventid:"01b4694b-0-"+s},on:{click:function(e){t.checkNav(s)}}},[t._v(t._s(e))])})),a("view",{staticClass:"code"},[a("view",{staticClass:"box"},[a("image",{staticClass:"img",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_login_user.png"}}),t.isPhone?a("image",{staticClass:"close",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_delete.png",eventid:"01b4694b-1"},on:{click:function(e){e.stopPropagation(),t.clearPhone(e)}}}):t._e(),a("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"input",attrs:{type:"number",placeholder:"请输入您的手机号",eventid:"01b4694b-2"},domProps:{value:t.phone},on:{input:[function(e){e.target.composing||(t.phone=e.target.value)},t.clickPhone]}})])]),0==t.navIndex?a("view",{staticClass:"passworld"},[a("view",{staticClass:"box"},[a("image",{staticClass:"img",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_login_code.png"}}),t.isCode?a("image",{staticClass:"close",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_delete.png",eventid:"01b4694b-3"},on:{click:function(e){e.stopPropagation(),t.clearCode(e)}}}):t._e(),a("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"input",attrs:{type:"number",placeholder:"请输入验证码",eventid:"01b4694b-4"},domProps:{value:t.code},on:{input:[function(e){e.target.composing||(t.code=e.target.value)},t.clickCode]}}),a("view",{staticClass:"code",class:{codeActive:t.isCodeActive},attrs:{eventid:"01b4694b-5"},on:{click:t.generateCode}},[t._v(t._s(t.codeText))])])]):t._e(),1==t.navIndex?a("view",{staticClass:"code pass"},[a("view",{staticClass:"box"},[a("image",{staticClass:"img",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_login_pass.png"}}),t.isPassworld?a("image",{staticClass:"close",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_delete.png",eventid:"01b4694b-6"},on:{click:function(e){e.stopPropagation(),t.clearPassworld(e)}}}):t._e(),a("input",{directives:[{name:"model",rawName:"v-model",value:t.passworld,expression:"passworld"}],staticClass:"input",attrs:{password:"",type:"text",placeholder:"请输入登录密码",eventid:"01b4694b-7"},domProps:{value:t.passworld},on:{input:[function(e){e.target.composing||(t.passworld=e.target.value)},t.clickPassworld]}})])]):t._e(),a("view",{staticClass:"forget",attrs:{eventid:"01b4694b-8"},on:{click:t.reset}},[t._v("忘记密码")]),a("view",{staticClass:"login text-666 text-center",class:{loginActive:t.isLogin},attrs:{eventid:"01b4694b-9"},on:{click:t.doLogin}},[t._v("登录")]),0==t.navIndex?a("view",{staticClass:"tips text-666 text-center"},[t._v("无需注册,可直接登录")]):t._e(),1==t.userType?a("view",{staticClass:"goBtn",attrs:{eventid:"01b4694b-10"},on:{click:function(e){t.goBtn(1)}}},[t._v("成为找料员")]):t._e(),2==t.userType?a("view",{staticClass:"goBtn",attrs:{eventid:"01b4694b-11"},on:{click:function(e){t.goBtn(2)}}},[t._v("成为配送员")]):t._e(),0==t.navIndex?a("view",{staticClass:"footer text-666 text-center",attrs:{eventid:"01b4694b-12"},on:{tap:t.showNotes}},[t._v("首次登录将自动注册,注册则代表您同意《用户协议》")]):t._e()])},o=[];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return o})},"90fe":function(t,e,a){"use strict";a.r(e);var s=a("0ba6"),o=a.n(s);for(var i in s)"default"!==i&&function(t){a.d(e,t,function(){return s[t]})}(i);e["default"]=o.a},ce4a:function(t,e,a){"use strict";var s=a("e011"),o=a.n(s);o.a},e011:function(t,e,a){},ef1d:function(t,e,a){"use strict";a.r(e);var s=a("53f2"),o=a("90fe");for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);a("ce4a");var n=a("2877"),c=Object(n["a"])(o["default"],s["a"],s["b"],!1,null,"083248e6",null);e["default"]=c.exports}},[["0515","common/runtime","common/vendor"]]]);