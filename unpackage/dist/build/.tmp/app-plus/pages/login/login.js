(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"0515":function(t,e,a){"use strict";a("a3d9");var o=n(a("b0ce")),s=n(a("ef1d"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,o.default)(s.default))},"0ba6":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(a("15b0")),s=i(a("e378")),n=i(a("0089"));i(a("d4cf"));function i(t){return t&&t.__esModule?t:{default:t}}var c={data:function(){return{title:"登录",navText:["验证码登录","密码登录"],phone:"",code:"",passworld:"",isPhone:!1,isCode:!1,isPassworld:!1,isLogin:!1,isCodeActive:!1,codeText:"获取验证码",from:0,code_id:"",userType:0}},components:{wxTitle:o.default},computed:{navIndex:function(){return this.$store.state.fromRest}},onLoad:function(t){t.from&&(this.$data.from=t.from)},onShow:function(){this.$data.userType=t.getStorageSync("userType")},methods:{getOpenId:function(){t.login({success:function(e){if(console.log(e),e.code){var a={code:e.code,from:3};n.default.getOpenId({data:a}).then(function(e){200==e.code||0==e.code?t.setStorageSync("open_id",e.data.openid):s.default.errorTips(e.msg)}).catch(function(t){})}}})},showNotes:function(){t.navigateTo({url:"../protocol/protocol"})},goBtn:function(e){1==e?t.navigateTo({url:"../setting/authentication/authentication"}):2==e&&t.navigateTo({url:"../setting/authentication/authentication"})},goblack:function(){t.navigateBack({delta:1})},checkNav:function(t){this.$store.commit("changeReset",{number:t}),this.judgeIsSelect()},judgeIsSelect:function(){0==this.$store.state.fromRest?s.default.vailPhone(this.$data.phone)&&""!=this.$data.code?this.$data.isLogin=!0:this.$data.isLogin=!1:1==this.$store.state.fromRest&&(s.default.vailPhone(this.$data.phone)&&""!=this.$data.passworld?this.$data.isLogin=!0:this.$data.isLogin=!1)},clickPhone:function(t){console.log(this.$data.phone),console.log(s.default.vailPhone(this.$data.phone)),this.$data.phone=t.target.value,""!=this.$data.phone?this.$data.isPhone=!0:this.$data.isPhone=!1,s.default.vailPhone(this.$data.phone)?this.$data.isCodeActive=!0:this.$data.isCodeActive=!1,this.judgeIsSelect()},clearPhone:function(){this.$data.phone="",this.$data.isLogin=!1,this.$data.isCodeActive=!1,this.judgeIsSelect(),this.$data.isPhone=!1,console.log(this.$data.phone)},clickCode:function(){""!=this.$data.code?this.$data.isCode=!0:this.$data.isCode=!1,this.judgeIsSelect()},clearCode:function(){this.$data.code="",this.$data.isLogin=!1,this.$data.isCode=!1},clickPassworld:function(){""!=this.$data.passworld?this.$data.isPassworld=!0:this.$data.isPassworld=!1,this.judgeIsSelect()},clearPassworld:function(){this.$data.passworld="",this.$data.isLogin=!1,this.$data.isPassworld=!1},generateCode:function(){var t=this;this.$data.isCodeActive&&n.default.generateCode({method:"POST",data:{mobile:this.$data.phone,type:2}}).then(function(e){0==e.code||200==e.code?(s.default.successTips("短信发送成功"),t.$data.code_id=e.data.id,t.$data.codeText="重新获取"):s.default.errorTips(e.msg)}).catch(function(t){s.default.errorTips(t.msg||t.message)})},doLogin:function(){var e=this,a=t.getStorageSync("userType"),o=t.getStorageSync("access_token"),i=t.getStorageSync("token"),c=t.getStorageSync("v");t.clearStorageSync(),t.setStorageSync("userType",a),t.setStorageSync("access_token",o),t.setStorageSync("token",i),t.setStorageSync("v",c),console.log("order"==t.getStorageSync("page")),this.$data.isLogin&&(0==this.$store.state.fromRest?n.default.loginByValidateCode({method:"POST",data:{mobile:this.$data.phone,code:this.$data.code,id:this.$data.code_id,invite_code:t.getStorageSync("invite_code")}}).then(function(a){if(0==a.code||200==a.code){e.getOpenId(),console.log("login:"+a);var o=a;t.getStorageSync("invite_code")&&t.removeStorageSync("invite_code"),t.setStorageSync("token",o.data.token),t.setStorageSync("userId",o.data.id),t.setStorageSync("access_token",o.data.access_token),t.setStorageSync("avatarPath",o.data.avatar_path),t.setStorageSync("user_name",o.data.user_name),t.setStorageSync("nick_name",o.data.nick_name),e.$store.commit("updateNickName",o.data.nick_name),e.$store.commit("updateAvatarPath",o.data.avatar_path),n.default.getUserInfo({}).then(function(t){o.data.name=name}),t.setStorageSync("userInfo",o.data),e.$store.commit("setToken",{token:o.data.token}),e.$store.commit("setUserInfo",{userInfo:o.data}),e.$eventHub.$emit("doUserInfo",o.data),e.$eventHub.$emit("order","order"),t.reLaunch({url:"../index/index?menuFrom="+e.$data.from})}else s.default.errorTips(a.msg)}).catch(function(t){s.default.errorTips(t.msg)}):n.default.login({method:"POST",data:{mobile:this.$data.phone,password:this.$data.passworld,invite_code:t.getStorageSync("invite_code")||""}}).then(function(a){if(0==a.code||200==a.code){e.getOpenId(),console.log("login:"+a.toString());var o=a;t.getStorageSync("invite_code")&&t.removeStorageSync("invite_code"),t.setStorageSync("token",o.data.token),t.setStorageSync("userId",o.data.id),t.setStorageSync("access_token",o.data.access_token),t.setStorageSync("avatarPath",o.data.avatar_path),t.setStorageSync("user_name",o.data.user_name),t.setStorageSync("nick_name",o.data.nick_name),e.$store.commit("updateNickName",o.data.nick_name),e.$store.commit("updateAvatarPath",o.data.avatar_path),n.default.getUserInfo().then(function(t){o.data.name=t.data.name}),t.setStorageSync("userInfo",o.data),e.$store.commit("setToken",{token:o.data.token}),e.$store.commit("setUserInfo",{userInfo:o.data}),e.$eventHub.$emit("doUserInfo",a.data),e.$eventHub.$emit("order","order"),t.reLaunch({url:"../index/index?menuFrom="+e.$data.from})}else s.default.errorTips(a.msg)}).catch(function(t){s.default.errorTips(t.msg||t.message)}))},reset:function(){t.navigateTo({url:"/pages/resetPassworld/resetPassworld"})}}};e.default=c}).call(this,a("6e42")["default"])},"2abb":function(t,e,a){},"719c":function(t,e,a){"use strict";var o=a("2abb"),s=a.n(o);s.a},"90fe":function(t,e,a){"use strict";a.r(e);var o=a("0ba6"),s=a.n(o);for(var n in o)"default"!==n&&function(t){a.d(e,t,function(){return o[t]})}(n);e["default"]=s.a},c984:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"wx_content fs24"},[a("view",{staticClass:"nav flex fw6"},t._l(t.navText,function(e,o){return a("view",{key:o,staticClass:"flex-1 text-center",class:{active:t.navIndex==o},attrs:{eventid:"01b4694b-0-"+o},on:{click:function(e){t.checkNav(o)}}},[t._v(t._s(e))])})),a("view",{staticClass:"code"},[a("view",{staticClass:"box"},[a("image",{staticClass:"img",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_login_user.png"}}),t.isPhone?a("image",{staticClass:"close",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_delete.png",eventid:"01b4694b-1"},on:{click:function(e){e.stopPropagation(),t.clearPhone(e)}}}):t._e(),a("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],staticClass:"input",attrs:{type:"text",placeholder:"请输入您的手机号",eventid:"01b4694b-2"},domProps:{value:t.phone},on:{input:[function(e){e.target.composing||(t.phone=e.target.value)},t.clickPhone]}})])]),0==t.navIndex?a("view",{staticClass:"passworld"},[a("view",{staticClass:"box"},[a("image",{staticClass:"img",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_login_code.png"}}),t.isCode?a("image",{staticClass:"close",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_delete.png",eventid:"01b4694b-3"},on:{click:function(e){e.stopPropagation(),t.clearCode(e)}}}):t._e(),a("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"input",attrs:{type:"number",placeholder:"请输入验证码",eventid:"01b4694b-4"},domProps:{value:t.code},on:{input:[function(e){e.target.composing||(t.code=e.target.value)},t.clickCode]}}),a("view",{staticClass:"code",class:{codeActive:t.isCodeActive},attrs:{eventid:"01b4694b-5"},on:{click:t.generateCode}},[t._v(t._s(t.codeText))])])]):t._e(),1==t.navIndex?a("view",{staticClass:"code pass"},[a("view",{staticClass:"box"},[a("image",{staticClass:"img",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_login_pass.png"}}),t.isPassworld?a("image",{staticClass:"close",attrs:{src:"https://static.yidap.com/miniapp/o2o/imgs/ic_delete.png",eventid:"01b4694b-6"},on:{click:function(e){e.stopPropagation(),t.clearPassworld(e)}}}):t._e(),a("input",{directives:[{name:"model",rawName:"v-model",value:t.passworld,expression:"passworld"}],staticClass:"input",attrs:{password:"",type:"text",placeholder:"请输入登录密码",eventid:"01b4694b-7"},domProps:{value:t.passworld},on:{input:[function(e){e.target.composing||(t.passworld=e.target.value)},t.clickPassworld]}})])]):t._e(),a("view",{staticClass:"forget",attrs:{eventid:"01b4694b-8"},on:{click:t.reset}},[t._v("忘记密码")]),a("view",{staticClass:"login text-666 text-center",class:{loginActive:t.isLogin},attrs:{eventid:"01b4694b-9"},on:{click:t.doLogin}},[t._v("登录")]),0==t.navIndex?a("view",{staticClass:"tips text-666 text-center"},[t._v("无需注册,可直接登录")]):t._e(),1==t.userType?a("view",{staticClass:"goBtn",attrs:{eventid:"01b4694b-10"},on:{click:function(e){t.goBtn(1)}}},[t._v("成为找料员")]):t._e(),2==t.userType?a("view",{staticClass:"goBtn",attrs:{eventid:"01b4694b-11"},on:{click:function(e){t.goBtn(2)}}},[t._v("成为配送员")]):t._e(),0==t.navIndex?a("view",{staticClass:"footer text-666 text-center",attrs:{eventid:"01b4694b-12"},on:{tap:t.showNotes}},[t._v("首次登录将自动注册,注册则代表您同意《用户协议》")]):t._e()])},s=[];a.d(e,"a",function(){return o}),a.d(e,"b",function(){return s})},ef1d:function(t,e,a){"use strict";a.r(e);var o=a("c984"),s=a("90fe");for(var n in s)"default"!==n&&function(t){a.d(e,t,function(){return s[t]})}(n);a("719c");var i=a("2877"),c=Object(i["a"])(s["default"],o["a"],o["b"],!1,null,"aa10f920",null);e["default"]=c.exports}},[["0515","common/runtime","common/vendor"]]]);