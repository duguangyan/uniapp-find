(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/fetchPage/fetchOrderDetail/fetchOrderDetail"],{"0abb":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"find-order-detail"},[a("view",{staticClass:"container tl"},[a("view",{staticClass:"b500 tl padding lh60 text-yellow"},[t._v(t._s(t.detailData.status_label))]),a("view",{staticClass:"padding fs30"},[a("view",[a("text",{staticClass:"c999"},[t._v("物料类型：")]),a("text",{staticClass:"text-666 fs24"},[t._v(t._s(t.detailData.cname))])]),a("view",{staticClass:"flex"},[a("view",{staticClass:"c999"},[t._v("物料描述：")]),a("view",{staticClass:"flex-1 text-666 fs24"},[t._v(t._s(t.detailData.desc))])]),a("view",{staticClass:"flex"},[a("view",{staticClass:"c999"},[t._v("比较优选：")]),a("view",{staticClass:"flex-1 text-666 fs24"},[t._v("参考价格 ￥ "+t._s(t.detailData.reference_price))])]),a("view",[a("view",{staticClass:"flex flex-start pdb30 image"},t._l(t.detailData.desc_img,function(e,s){return a("image",{key:s,attrs:{src:e,"data-idx":s,mode:"aspectFill",eventid:"766bc8f4-0-"+s},on:{click:t.preview}})}))]),a("view",{staticClass:"item-right fs24 text-yellow"},[a("view",{staticClass:"c999"},[t._v(t._s(t.detailData.find_type_label))]),a("view",{staticClass:"c999"},[t._v("费用:￥"+t._s(t.detailData.fee))])])]),a("view",{staticClass:"top20"}),t.detailData.get_address?a("view",{staticClass:"get-address"},[a("view",{staticClass:"t1 fs28"},[t._v("取料地址")]),a("view",{staticClass:"t2 fs24"},[a("text",[t._v("收货人 "+t._s(t.detailData.get_address.mobile))]),t.detailData.get_address.stall?a("text",[t._v(t._s(t.detailData.get_address.stall))]):t._e()]),a("view",{staticClass:"t3 fs24 text-999"},[t._v(t._s(t.detailData.get_address.address))])]):t._e(),t.detailData.shipping_address?a("view",{staticClass:"get-address"},[a("view",{staticClass:"t1 fs28"},[t._v("送料地址")]),a("view",{staticClass:"t2 fs24"},[a("text",[t._v("收货人 "+t._s(t.detailData.shipping_address.mobile))]),t.detailData.shipping_address.stall?a("text",[t._v(t._s(t.detailData.shipping_address.stall))]):t._e()]),a("view",{staticClass:"t3 fs24 text-999"},[t._v(t._s(t.detailData.shipping_address.address))])]):t._e(),a("view",{staticClass:"pdl-30 bt-1 lh100"},[a("text",{staticClass:"fs28"},[t._v("配送方式:")]),a("text",{staticClass:"fs24 text-999 mgl-20"},[t._v(t._s(t.detailData.find_type_label))])]),a("view",{staticClass:"pdl-30 bt-1 top20 order_sn"},[a("view",[a("text",{staticClass:"fs28"},[t._v("订单编号:")]),a("text",{staticClass:"fs24 text-999 mgl-20"},[t._v(t._s(t.detailData.order_sn))])]),a("view",[a("text",{staticClass:"fs28"},[t._v("下单时间:")]),a("text",{staticClass:"fs24 text-999 mgl-20"},[t._v(t._s(t.detailData.created_at))])])]),3==t.detailData.distribution_status?a("view",{staticClass:"order-info"},[a("view",{staticClass:"desc cf"},[t._m(0),a("view",{staticClass:"t2 fll"},[t.isLogistics||t.formShow?t._e():a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.detailData.result_desc,expression:"detailData.result_desc"}],attrs:{disabled:t.disabled,placeholder:"(注:请详细描述物料的名称、用途、材质、交货时间)",eventid:"766bc8f4-1"},domProps:{value:t.detailData.result_desc},on:{input:function(e){e.target.composing||(t.detailData.result_desc=e.target.value)}}})])]),a("view",{staticClass:"upload"},[t._m(1),a("view",{staticClass:"t2"},[a("view",{staticClass:"desc_img"},t._l(t.detailData.result_img,function(t,e){return a("image",{key:e,attrs:{src:t,mode:""}})}))])]),a("view",{staticClass:"supplier cf"},[t._m(2),a("view",{staticClass:"t2 fll"},[a("view",[t._v(t._s(t.detailData.distribution_name))])])]),a("view",{staticClass:"price cf"},[t._m(3),a("view",{staticClass:"t2 fll"},[a("view",[t._v(t._s(t.detailData.result_price))])])]),a("view",{staticClass:"mun1 cf fs28"},[t._m(4),a("view",{staticClass:"t2 fll"},[a("text",[t._v(t._s(t.detailData.result_num))]),a("text",{staticClass:"piece"},[t._v("件")])])]),a("view",{staticClass:"mun2 cf fs28"},[t._m(5),a("view",{staticClass:"t2 fll"},[a("text",[t._v(t._s(t.detailData.result_big_num))]),a("text",{staticClass:"piece"},[t._v("件")]),a("text",{staticClass:"text-red mgl-20"},[t._v("* ￥"+t._s(t.big_price))])])]),a("view",{staticClass:"cost"},[a("text",{staticClass:"t1 fs28"},[t._v("合计费用:")]),a("text",{staticClass:"t2 mgl-20 text-red"},[t._v("￥ "+t._s(t.totalFee))])])]):t._e(),t.detailData.distribution_status>=4?a("view",{staticClass:"status-2"},[a("view",{staticClass:"li"},[a("text",{staticClass:"fs28"},[t._v("物料单价:")]),a("text",{staticClass:"fs24 text-999 mgl-20"},[t._v("￥"+t._s(t.detailData.result_price))])]),a("view",{staticClass:"li"},[a("text",{staticClass:"fs28"},[t._v("物料数量:")]),a("text",{staticClass:"fs24 text-999 mgl-20"},[t._v(t._s(t.detailData.result_num))])]),a("view",{staticClass:"li"},[a("text",{staticClass:"fs28"},[t._v("大货配送费:")]),a("text",{staticClass:"fs24 text-999 mgl-20"},[t._v("￥"+t._s(t.detailData.result_extra_fee)+" ("+t._s(t.detailData.result_big_num)+" * "+t._s(t.big_price)+")")])]),t.detailData.desc_img.length>0&&t.detailData.desc_img?a("view",{staticClass:"img cf"},t._l(t.detailData.desc_img,function(t,e){return a("image",{key:e,staticClass:"fll",attrs:{src:t,mode:""}})})):t._e()]):t._e(),6==t.detailData.distribution_status?a("view",{staticClass:"evaluate pd-30 bt-1"},[a("view",{staticClass:"v1"},[a("text",{staticClass:"fs28"},[t._v("找料服务:")]),a("text",{staticClass:"mgl-20"},t._l(t.detailData.find_star,function(t,e){return a("text",{key:t,staticClass:"star iconfont icon-star text-yellow"})}))]),a("view",{staticClass:"v1"},[a("text",{staticClass:"fs28"},[t._v("配送服务:")]),a("text",{staticClass:"mgl-20"},t._l(t.detailData.dist_star,function(t,e){return a("text",{key:t,staticClass:"star iconfont icon-star text-yellow"})}))]),a("view",{staticClass:"v1"},[a("text",{staticClass:"fs28"},[t._v("服务反馈:")]),a("text",{staticClass:"fs24 text-999 mgl-20"},[t._v(t._s(t.detailData.comment))])])]):t._e(),a("view",{staticClass:"flex-end order-handle cf"},[2==t.detailData.distribution_status?a("view",{staticClass:"find-status flr",attrs:{eventid:"766bc8f4-2"},on:{click:function(e){t.receiptOrder(t.detailData.id)}}},[t._v("确认接单")]):t._e(),3==t.detailData.distribution_status?a("view",{staticClass:"find-status flr",attrs:{eventid:"766bc8f4-3"},on:{click:function(e){t.serviceOrder(t.detailData.id)}}},[t._v("确认送达")]):t._e(),""!=t.detailData.user_id?a("view",{staticClass:"find-status flr",attrs:{eventid:"766bc8f4-4"},on:{click:function(e){t.goChat(t.detailData)}}},[t._v("联系客户")]):t._e()])]),t.formShow?a("view",{staticClass:"pop-window"},[a("view",{staticClass:"form-box-2"},[a("text",{staticClass:"iconfont icon-guanbi close",attrs:{eventid:"766bc8f4-5"},on:{click:function(e){e.stopPropagation(),t.close(e)}}}),a("view",[a("view",{staticClass:"fs34 b600"},[t._v("填写原因")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.remark,expression:"remark"}],staticClass:"tl reason bdb bdt textarea",attrs:{placeholder:1==t.detailData.type?"请填写找不到物料的原因":"请填写取不到物料的原因",eventid:"766bc8f4-6"},domProps:{value:t.remark},on:{input:function(e){e.target.composing||(t.remark=e.target.value)}}}),a("view",{staticClass:"submit-box flex bt-1"},[a("view",{staticClass:"flex-1 fs28",attrs:{eventid:"766bc8f4-7"},on:{click:function(e){e.stopPropagation(),t.close(e)}}},[t._v("取消")]),a("view",{staticClass:"flex-1 fs28 sub",attrs:{eventid:"766bc8f4-8"},on:{click:function(e){e.stopPropagation(),t.unFormSubmit(e)}}},[t._v("提交")])])])])]):t._e(),t.isLogistics?a("view",{staticClass:"logistics-wap"},[a("view",{staticClass:"bg",attrs:{eventid:"766bc8f4-9"},on:{click:function(e){e.stopPropagation(),t.hideLogistics(e)}}}),a("view",{staticClass:"content"},[a("view",{staticClass:"v1"},[a("text",[t._v("物流公司:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.express_name,expression:"express_name"}],attrs:{type:"text",placeholder:"请输入物流公司名称",eventid:"766bc8f4-10"},domProps:{value:t.express_name},on:{input:function(e){e.target.composing||(t.express_name=e.target.value)}}})]),a("view",{staticClass:"v2"},[a("text",[t._v("联系电话:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.express_phone,expression:"express_phone"}],attrs:{type:"number",placeholder:"请输入物流公司电话",eventid:"766bc8f4-11"},domProps:{value:t.express_phone},on:{input:function(e){e.target.composing||(t.express_phone=e.target.value)}}})]),a("view",{staticClass:"v3",attrs:{eventid:"766bc8f4-13"},on:{click:t.logisticsSubmit}},[a("text",[t._v("物流单号:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.express_sn,expression:"express_sn"}],attrs:{type:"number",placeholder:"请输入物流单号",eventid:"766bc8f4-12"},domProps:{value:t.express_sn},on:{input:function(e){e.target.composing||(t.express_sn=e.target.value)}}})]),a("view",{staticClass:"btn",attrs:{eventid:"766bc8f4-14"},on:{click:function(e){e.stopPropagation(),t.logisticsSubmit(e)}}},[t._v("提交")]),a("view",{staticClass:"closeBtn",attrs:{eventid:"766bc8f4-15"},on:{click:function(e){e.stopPropagation(),t.hideLogistics(e)}}},[a("image",{attrs:{src:"/static/icon/closed_btn.png",mode:""}})])])]):t._e()])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"t1 fll"},[a("text",{staticClass:"text-red"},[t._v("*")]),a("text",[t._v("描述:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"t1 fs28"},[a("text",{staticClass:"text-red"},[t._v("*")]),a("text",[t._v("上传图片:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"fll t1 fs28"},[a("text",{staticClass:"text-red"},[t._v("*")]),a("text",[t._v("配送员:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"t1 fll"},[a("text",{staticClass:"text-red"},[t._v("*")]),a("text",[t._v("物料单价:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"t1 fll"},[a("text",{staticClass:"text-red"},[t._v("*")]),a("text",[t._v("物料数量:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"t1 fll"},[a("text",{staticClass:"text-red",staticStyle:{opacity:"0"}},[t._v("*")]),a("text",[t._v("大货数量:")])])}];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return i})},"3e9e":function(t,e,a){"use strict";a("a3d9");var s=l(a("b0ce")),i=l(a("e191"));function l(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(i.default))},"4f83":function(t,e,a){},"53cb0":function(t,e,a){"use strict";var s=a("4f83"),i=a.n(s);i.a},c33c:function(t,e,a){"use strict";a.r(e);var s=a("fa1a"),i=a.n(s);for(var l in s)"default"!==l&&function(t){a.d(e,t,function(){return s[t]})}(l);e["default"]=i.a},e191:function(t,e,a){"use strict";a.r(e);var s=a("0abb"),i=a("c33c");for(var l in i)"default"!==l&&function(t){a.d(e,t,function(){return i[t]})}(l);a("53cb0");var r=a("2877"),c=Object(r["a"])(i["default"],s["a"],s["b"],!1,null,"768c5171",null);e["default"]=c.exports},fa1a:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(a("0089")),i=n(a("e378")),l=n(a("8dde")),r=n(a("483a")),c=n(a("10c9")),d=n(a("3db4"));function n(t){return t&&t.__esModule?t:{default:t}}var o={components:{upload:l.default,uniNumberBox:r.default,xflSelect:c.default,dialog:d.default},data:function(){return{isLogistics:!1,disabled:!0,totalCost:0,result_num:0,result_big_num:0,orderItem:"",index:1,upLoadMaxNum:9,files:[],id:"",detailData:"",result_desc:"",big_price:0,result_price:0,supplier:"",list:[],supplier_id:"",isCheckSupplier:!1,formShow:!1,remark:"",express_name:"",express_phone:"",express_sn:"",totalFee:""}},onLoad:function(t){this.$data.id=t.id,this.getTaskFee()},onShow:function(){},methods:{goChat:function(e){t.navigateTo({url:"/pages/chat/chat?id="+e.user_id+"&fmUserName=客户"})},logisticsSubmit:function(){var e=this;return""==this.$data.express_name?(i.default.errorTips("请填写物流公司"),!1):""==this.$data.express_phone?(i.default.errorTips("请填写物流电话"),!1):""==this.$data.express_sn?(i.default.errorTips("请填写物流单号"),!1):void s.default.staffShipExpress({method:"POST",data:{id:this.$data.id,express_name:this.$data.express_name,express_phone:this.$data.express_phone,express_sn:this.$data.express_sn,express_img:this.$data.detailData.result_img[0]}}).then(function(a){0==a.code||200==a.code?(e.$data.isLogistics=!1,e.$data.detailData.distribution_status=4,e.$data.detailData.status_label="确认送达",t.navigateBack({delta:1})):i.default.errorTips(a.msg)}).catch(function(t){i.default.errorTips(t.msg||t.meessage)})},hideLogistics:function(){this.$data.isLogistics=!1},serviceOrder:function(e){var a=this;t.showModal({title:"提示",content:"确认送达?",success:function(i){i.confirm?(console.log("用户点击确定"),2!=a.$data.detailData.shipping_type?s.default.staffShipConfirm({method:"POST",data:{id:e}}).then(function(e){0!=e.code&&200!=e.code||(a.$data.detailData.distribution_status=4,a.$data.detailData.status_label="确认送达",t.navigateTo({url:"../../pages/index"}))}):a.$data.isLogistics=!0):i.cancel&&console.log("用户点击取消")}})},receiptOrder:function(e){var a=this;t.showModal({title:"提示",content:"确定接单?",success:function(l){l.confirm?(console.log("用户点击确定"),s.default.staffShipGet({method:"POST",data:{id:e}}).then(function(e){200==e.code||0==e.code?(a.$data.status=2,i.default.successTips("接单成功"),a.detailData.distribution_status=3,t.navigateBack({delta:1})):i.default.errorTips(e.msg)}).catch(function(t){i.default.errorTips(t.msg)})):l.cancel&&console.log("用户点击取消")}})},showForm:function(){this.$data.formShow=!0},unFormSubmit:function(){var e=this;if(""==this.$data.remark)return i.default.errorTips("请填写未找到料的原因"),!1;var a={id:this.$data.id,remark:this.$data.remark};s.default.staffFindUnfound({method:"POST",data:a}).then(function(a){200!=a.code&&0!=a.code||(e.$data.formShow=!1,t.navigateTo({url:"../../pages/index"}))})},close:function(){this.$data.formShow=!1},submit:function(){if(""==this.$data.result_desc)return i.default.errorTips("描述不能为空"),!1;if(this.$data.files.length<=0)return i.default.errorTips("至少上传一张图片"),!1;if(""==this.$data.supplier_id)return i.default.errorTips("请选择供应商"),!1;if(""==this.$data.result_price)return i.default.errorTips("物料单价不能为空"),!1;if(this.$data.result_num<=0)return i.default.errorTips("物料数量不能为空"),!1;var e=[];this.$data.files.forEach(function(t,a){e.push(t.url)});var a={id:this.$data.id,supplier_id:this.$data.supplier_id,result_desc:this.$data.result_desc,result_img:e,result_price:this.$data.result_price,result_num:this.$data.result_num,result_big_num:this.$data.result_big_num};s.default.staffFindFound({method:"POST",data:a}).then(function(e){200==e.code||0==e.code?t.navigateBack({delta:1}):i.default.errorTips(e.msg)})},checkSupplier:function(t){this.$data.supplier=this.$data.list[t].name,this.$data.supplier_id=this.$data.list[t].id,this.$data.isCheckSupplier=!1},sum:function(){this.$data.totalCost=this.$data.result_num*this.$data.result_price+this.$data.result_big_num*this.$data.big_price},staffSupplierSearch:function(t){var e=this;this.$data.supplier_id="",""!=t.detail.value&&s.default.staffSupplierSearch({data:{keyword:t.detail.value}}).then(function(t){200!=t.code&&0!=t.code||(e.$data.list=t.data,t.data.length<=0?e.$data.isCheckSupplier=!1:e.$data.isCheckSupplier=!0)})},getPriceByOne:function(t){this.$data.result_price=t.detail.value,this.sum()},bindChange1:function(t){this.$data.result_num=t,this.sum()},bindChange2:function(t){this.$data.result_big_num=t,this.sum()},getTaskFee:function(){var t=this;s.default.getTaskFee({}).then(function(e){200!=e.code&&0!=e.code||(t.$data.big_price=e.data.big_price,t.getOrderDetail(t.$data.id))})},imageUpload:function(t){this.$data.files=t.files},getOrderDetail:function(t){var e=this;s.default.shipShowById({data:{id:t}}).then(function(t){200!=t.code&&0!=t.code||(e.$data.detailData=t.data,e.$data.totalFee=parseInt(t.data.result_num)*parseFloat(t.data.result_price)+parseInt(t.data.result_big_num)*parseFloat(e.$data.big_price),e.sum())})},preview:function(e){var a=e.currentTarget.dataset.idx,s=this.data.detailData.desc_img;t.previewImage({current:s[a],urls:s})}}};e.default=o}).call(this,a("6e42")["default"])}},[["3e9e","common/runtime","common/vendor"]]]);