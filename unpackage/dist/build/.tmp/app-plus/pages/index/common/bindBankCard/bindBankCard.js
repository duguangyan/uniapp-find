(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/common/bindBankCard/bindBankCard"],{"41d2":function(t,a,e){"use strict";e("a3d9");var i=d(e("b0ce")),n=d(e("cd7b"));function d(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(n.default))},"58f5":function(t,a,e){"use strict";var i=e("df9b"),n=e.n(i);n.a},"64dc":function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=d(e("e378")),n=d(e("0089"));function d(t){return t&&t.__esModule?t:{default:t}}var r={data:function(){return{btnText:"立即绑定",codeBtnTxt:"获取验证码",code_id:"",bank_card_type:0,bank_name:"",items:[{t:"持卡人姓名",v:"",p:"请输入持卡人姓名"},{t:"储蓄卡号",v:"",p:"请上传储蓄银行卡正面照片"},{t:"开户银行",v:"",p:"请输入开户银行"},{t:"开户网点",v:"",p:"请输入开户网点信息"},{t:"手机号码",v:"",p:"请输入您的手机号码"},{t:"短信验证码",v:"",p:"请输入短信验证码"}]}},onLoad:function(t){1==t.edit&&this.memberBankCardBind()},onShow:function(){},methods:{memberBankCardBind:function(){var t=this;n.default.memberBankCardBind({}).then(function(a){if(200==a.code||0==a.code){var e=a.data;t.$data.items[0].v=e.real_name,t.$data.items[1].v=e.bank_card_number,t.$data.items[2].v=e.bank_name,t.$data.items[3].v=e.bank_card_opening,t.$data.items[4].v=e.mobile,t.$data.bank_card_type=e.bank_card_type,t.$data.bank_card_img=e.bank_card_img}else i.default.errorTips(a.msg)}).catch(function(t){i.default.errorTips(t.msg||t.message)})},getBankCardInfo:function(a){var e=this;t.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){var d=wx.getStorageSync("access_token")||"",r={file:"[object Object]",type:"big"},s=Date.parse(new Date);r.timestamp=s,r.sign=i.default.makeSign(n.default.apiUrl+"/api/upload",r),r.deviceId="wx",r.platformType="2",r.versionCode="4.0";wx.uploadFile({url:"".concat(n.default.apiUrl,"/api/upload"),filePath:t.tempFilePaths[0],name:"file",header:{"content-type":"multipart/form-data",Accept:"application/json",Authorization:"Bearer ".concat(d)},formData:r,success:function(t){console.log("图片上传"),console.log(t);var d=JSON.parse(t.data);200===d.code||0===d.code?(e.$data.bank_card_img=d.data,n.default.apiOcrBankCard({method:"POST",data:{bank_card_img:d.data}}).then(function(t){200!=t.code&&0!=t.code||(e.$data.bank_card_type=t.data.bank_card_type,e.$data.items[2].v=t.data.bank_name,e.$data.bank_name=t.data.bank_name,e.$data.items[a].v=t.data.bank_card_number)})):i.default.errorTips("上传错误")},fail:function(t){console.log(t)},complete:function(){}})}})},bindAlipay:function(){if(""==this.$data.items[0].v)return i.default.errorTips("请输入您的银行卡姓名"),!1;if(""==this.$data.items[1].v)return i.default.errorTips("请输入您的储蓄卡卡号"),!1;if(""==this.$data.items[2].v)return i.default.errorTips("请输入您的开户银行"),!1;if(""==this.$data.items[3].v)return i.default.errorTips("请输入您的开户银行网点地址"),!1;if(""==this.$data.items[4].v)return i.default.errorTips("请输入您的手机号"),!1;if(""==this.$data.items[5].v)return i.default.errorTips("请输入短信验证码"),!1;if(""==this.$data.code_id)return i.default.errorTips("请重新获取验证码"),!1;if(this.$data.bank_card_type>1)return i.default.errorTips("此类型卡不能办理提现业务，请重新上传储蓄卡照片"),!1;var a={bank_name:this.$data.items[2].v,real_name:this.$data.items[0].v,id:this.$data.code_id,mobile:this.$data.items[4].v,code:this.$data.items[5].v,bank_card_number:this.$data.items[1].v,bank_card_type:this.$data.bank_card_type,bank_card_opening:this.$data.items[3].v,bank_card_img:this.$data.bank_card_img};n.default.memberBankCardBind({method:"POST",data:a}).then(function(a){200==a.code||0==a.code?(i.default.successTips(a.msg),t.navigateBack({delta:1})):i.default.errorTips(a.msg)}).catch(function(t){i.default.errorTips(t.msg||t.message)})},getCode:function(){var t=this;if(""==this.$data.items[4].v)return i.default.errorTips("手机号不能为空"),!1;if(!i.default.vailPhone(this.$data.items[4].v))return i.default.errorTips("请输入正确手机号"),!1;var a={mobile:this.$data.items[4].v};n.default.regSMS({method:"POST",data:a}).then(function(a){200==a.code||0==a.code?(t.$data.code_id=a.data.id,i.default.errorTips("短信发送成功"),t.$data.codeBtnTxt="重新获取"):i.default.errorTips(a.msg)}).catch(function(t){i.default.errorTips(t.msg||t.message)})}}};a.default=r}).call(this,e("6e42")["default"])},"7d28":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("view",{staticClass:"alipay"},[e("view",{staticClass:"items"},t._l(t.items,function(a,i){return e("view",{key:i,staticClass:"item"},[e("text",[t._v(t._s(a.t))]),t._v(":"),e("input",{directives:[{name:"model",rawName:"v-model",value:a.v,expression:"item.v"}],class:{"item-2":1==i,"item-5":5==i},attrs:{disabled:1==i,type:"text",placeholder:a.p,eventid:"48e5e480-0-"+i},domProps:{value:a.v},on:{input:function(t){t.target.composing||(a.v=t.target.value)}}}),1==i?e("view",{staticClass:"item-5-btn",attrs:{eventid:"48e5e480-1-"+i},on:{click:function(a){t.getBankCardInfo(i)}}},[e("image",{attrs:{src:"../../../../static/icon/xinji.png"}})]):t._e(),5==i?e("view",{staticClass:"item-2-btn",attrs:{eventid:"48e5e480-2-"+i},on:{click:t.getCode}},[t._v(t._s(t.codeBtnTxt))]):t._e()])})),e("view",{staticClass:"btn",attrs:{eventid:"48e5e480-3"},on:{click:t.bindAlipay}},[t._v("立即绑定")])])},n=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return n})},"958d":function(t,a,e){"use strict";e.r(a);var i=e("64dc"),n=e.n(i);for(var d in i)"default"!==d&&function(t){e.d(a,t,function(){return i[t]})}(d);a["default"]=n.a},cd7b:function(t,a,e){"use strict";e.r(a);var i=e("7d28"),n=e("958d");for(var d in n)"default"!==d&&function(t){e.d(a,t,function(){return n[t]})}(d);e("58f5");var r=e("2877"),s=Object(r["a"])(n["default"],i["a"],i["b"],!1,null,"4f4b304f",null);a["default"]=s.exports},df9b:function(t,a,e){}},[["41d2","common/runtime","common/vendor"]]]);