(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/addressNew/addressNew"],{"54ec":function(e,t,a){"use strict";a.r(t);var s=a("90f4"),o=a.n(s);for(var n in s)"default"!==n&&function(e){a.d(t,e,function(){return s[e]})}(n);t["default"]=o.a},"68e1":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",{staticClass:"new-address"},[a("view",{staticClass:"fs30 address-form"},[a("view",{staticClass:"flex lh90 address-list"},[e._m(0),e._v(":"),a("input",{directives:[{name:"model",rawName:"v-model",value:e.addressInfo.consignee,expression:"addressInfo.consignee"}],staticClass:"address-input",attrs:{placeholder:"收货人姓名",eventid:"f5b18012-0"},domProps:{value:e.addressInfo.consignee},on:{input:function(t){t.target.composing||(e.addressInfo.consignee=t.target.value)}}})]),a("view",{staticClass:"flex lh90 address-list"},[e._m(1),a("input",{directives:[{name:"model",rawName:"v-model",value:e.addressInfo.mobile,expression:"addressInfo.mobile"}],staticClass:"address-input",attrs:{placeholder:"收货人手机号码",maxlength:"11",eventid:"f5b18012-1"},domProps:{value:e.addressInfo.mobile},on:{input:function(t){t.target.composing||(e.addressInfo.mobile=t.target.value)}}})]),a("view",{staticClass:"flex lh90 address-list",attrs:{eventid:"f5b18012-3"},on:{click:e.getMapAddress}},[e._m(2),a("input",{directives:[{name:"model",rawName:"v-model",value:e.addressInfo.address,expression:"addressInfo.address"}],staticClass:"address-input ellipsis",attrs:{placeholder:"请填写地址",disabled:!0,eventid:"f5b18012-2"},domProps:{value:e.addressInfo.address},on:{input:function(t){t.target.composing||(e.addressInfo.address=t.target.value)}}}),a("text",{staticClass:"iconfont icon-jiantou1"})]),a("view",{staticClass:"flex lh90 address-list"},[e._m(3),a("input",{directives:[{name:"model",rawName:"v-model",value:e.addressInfo.room,expression:"addressInfo.room"}],staticClass:"address-input",attrs:{placeholder:"例如: 1栋16楼116室XXX公司",eventid:"f5b18012-4"},domProps:{value:e.addressInfo.room},on:{input:function(t){t.target.composing||(e.addressInfo.room=t.target.value)}}})]),a("view",{staticClass:"flex lh90 address-list"},[e._m(4),a("input",{directives:[{name:"model",rawName:"v-model",value:e.addressInfo.stall,expression:"addressInfo.stall"}],staticClass:"address-input",attrs:{placeholder:"公司名称、档口名称等",eventid:"f5b18012-5"},domProps:{value:e.addressInfo.stall},on:{input:function(t){t.target.composing||(e.addressInfo.stall=t.target.value)}}})]),a("view",{staticClass:"flex lh90 address-list"},[e._m(5),a("input",{directives:[{name:"model",rawName:"v-model",value:e.addressInfo.remark,expression:"addressInfo.remark"}],staticClass:"address-input",attrs:{placeholder:"不超过两个字,例如:找料、送料",eventid:"f5b18012-6"},domProps:{value:e.addressInfo.remark},on:{input:function(t){t.target.composing||(e.addressInfo.remark=t.target.value)}}})]),a("view",{staticClass:"check-btn mgt-20 mgb-20"},[a("text",{staticClass:"mgl-20"},[e._v("设为默认地址")]),a("switch",{staticClass:"flr",attrs:{color:"#F29800",eventid:"f5b18012-7"},on:{change:e.switchChange}})])]),a("view",{staticClass:"bottom-fixed btn-shadow h100 text-center lh100 text-white fs30",attrs:{"hover-class":"hover-style",eventid:"f5b18012-8"},on:{click:e.saveSubmit}},[e._v("保存")]),e.showCon?a("view",{staticClass:"modal-mask"},[a("view",{staticClass:"modal-dialog"},[a("view",{staticClass:"modal-title"},[e._v("温馨提示")]),a("view",{staticClass:"modal-content"},[e._v("获取定位失败，请前往设置打开定位权限")]),a("view",{staticClass:"modal-footer"},[a("view",{staticClass:"btn-cancel",attrs:{eventid:"f5b18012-9"},on:{click:e.changeModalCancel}},[e._v("取消")]),a("button",{staticClass:"btn-confirm button-on-view",staticStyle:{padding:"0rpx"},attrs:{"open-type":"openSetting",eventid:"f5b18012-10"},on:{click:e.changeModal}},[e._v("设置")])],1)])]):e._e()])},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",[a("text",{staticClass:"text-theme"},[e._v("*")]),a("text",{staticClass:"spacing"},[e._v("收货人")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",[a("text",{staticClass:"text-theme"},[e._v("*")]),e._v("联系电话:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",[a("text",{staticClass:"text-theme"},[e._v("*")]),a("text",[e._v("所在地区:")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",[a("text",{staticClass:"text-theme display-none"},[e._v("*")]),e._v("详细地址:")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",[a("text",{staticClass:"text-theme display-none"},[e._v("*")]),a("text",[e._v("名称:")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",[a("text",{staticClass:"text-theme display-none"},[e._v("*")]),a("text",[e._v("标签:")])])}];a.d(t,"a",function(){return s}),a.d(t,"b",function(){return o})},"6cb2":function(e,t,a){"use strict";var s=a("f9d2"),o=a.n(s);o.a},"90f4":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(a("e378")),o=n(a("0089"));function n(e){return e&&e.__esModule?e:{default:e}}var i,r=a("cabb"),d={data:function(){return{addressInfo:{address:"",consignee:"",mobile:"",latitude:"",longitude:"",room:"",stall:"",remark:"",is_default:"",name:""},showCon:!1,check:!1,type:"",id:""}},onLoad:function(t){i=new r({key:"TREBZ-NE3KW-VZ5RD-OFP22-IUGZO-MEF7A"}),this.$data.type=t.type,"new"==t.type?this.getUserMapAddress():"edit"==t.type&&(e.setNavigationBarTitle({title:"编辑收货地址"}),this.$data.id=t.id,this.getAddressInfo(this.$data.id))},onShow:function(){},methods:{switchChange:function(e){console.log("switch2 发生 change 事件，携带值为",e.target.value),this.$data.check=e.target.value},getAddressInfo:function(e){var t=this;o.default.infoAddress({data:{id:e}}).then(function(e){var a=e.data;t.$data.addressInfo=a,t.$data.check=0!=a.is_default})},saveSubmit:function(){var t=this.$data.addressInfo,a=this.$data.type;return 0===t.consignee.length?(s.default.errorTips("请确认收货人"),!1):s.default.vailPhone(t.mobile)?t.address?t.remark.length>2?(s.default.errorTips("标签信息不超过2个字"),!1):(this.$data.addressInfo.is_default=this.$data.check?1:0,void("new"==a?o.default.addAddress({method:"POST",data:this.$data.addressInfo}).then(function(t){200==t.code||0==t.code?(s.default.successTips(t.msg),e.navigateBack()):s.default.errorTips(t.msg)}).catch(function(e){s.default.errorTips(e.msg||e.message)}):"edit"==a&&o.default.editAddress({method:"POST",data:this.$data.addressInfo}).then(function(e){200==e.code||0==e.code?(s.default.successTips(e.msg),wx.navigateBack()):s.default.errorTips(e.msg)}).catch(function(e){s.default.errorTips(e.msg||e.message)}))):(s.default.errorTips("请确认地址信息"),!1):(s.default.errorTips("请确认手机号"),!1)},doCheck:function(){this.$data.check=!this.$data.check},changeModal:function(){this.$data.showCon=!1},changeModalCancel:function(){this.$data.showCon=!1},getUserMapAddress:function(){var t=this;e.getLocation({type:"gcj02",success:function(e){var a=e.latitude,s=e.longitude;e.speed,e.accuracy;console.log("----------------------"),console.log(e),i.reverseGeocoder({location:{latitude:a,longitude:s},success:function(e){var a={address:e.result.address,city:e.result.address_component.city,district:e.result.address_component.district,location:e.result.location,province:e.result.address_component.province,title:e.result.formatted_addresses.recommend};console.log("mapAddress--\x3e>",a),null!=a.location&&void 0!=a.location&&""!=a.location&&(t.$data.addressInfo.address=a.address,t.$data.addressInfo.consignee=wx.getStorageSync("nick_name")||"",t.$data.addressInfo.mobile=wx.getStorageSync("user_name")||"",t.$data.addressInfo.latitude=a.location.lat.toString(),t.$data.addressInfo.longitude=a.location.lng.toString())},fail:function(e){console.log(e)},complete:function(e){console.log(e)}})}})},getMapAddress:function(){var t=this,a=this;e.chooseLocation({success:function(e){t.$data.addressInfo.address=e.address,t.$data.addressInfo.name=e.name,t.$data.addressInfo.latitude=e.latitude.toString(),t.$data.addressInfo.longitude=e.longitude.toString(),t.$data.addressInfo.room=e.name==e.address?"":e.name},fail:function(t){s.default.errorTips("获取地图定位失败："+t.errMsg),e.getSetting({success:function(e){e.authSetting["scope.userLocation"]||(a.$data.showCon=!0)}})},complete:function(e){}})}}};t.default=d}).call(this,a("6e42")["default"])},a32c:function(e,t,a){"use strict";a("a3d9");var s=n(a("b0ce")),o=n(a("d1e1"));function n(e){return e&&e.__esModule?e:{default:e}}Page((0,s.default)(o.default))},cabb:function(e,t,a){"use strict";var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n={KEY_ERR:311,KEY_ERR_MSG:"key格式错误",PARAM_ERR:310,PARAM_ERR_MSG:"请求参数信息有误",SYSTEM_ERR:600,SYSTEM_ERR_MSG:"系统错误",WX_ERR_CODE:1e3,WX_OK_CODE:200},i="https://apis.map.qq.com/ws/",r=i+"place/v1/search",d=i+"place/v1/suggestion",c=i+"geocoder/v1/",l=i+"district/v1/list",u=i+"district/v1/getchildren",f=i+"distance/v1/",v={location2query:function(e){if("string"==typeof e)return e;for(var t="",a=0;a<e.length;a++){var s=e[a];t&&(t+=";"),s.location&&(t=t+s.location.lat+","+s.location.lng),s.latitude&&s.longitude&&(t=t+s.latitude+","+s.longitude)}return t},getWXLocation:function(e,t,a){wx.getLocation({type:"gcj02",success:e,fail:t,complete:a})},getLocationParam:function(e){if("string"==typeof e){var t=e.split(",");e=2===t.length?{latitude:e.split(",")[0],longitude:e.split(",")[1]}:{}}return e},polyfillParam:function(e){e.success=e.success||function(){},e.fail=e.fail||function(){},e.complete=e.complete||function(){}},checkParamKeyEmpty:function(e,t){if(!e[t]){var a=this.buildErrorConfig(n.PARAM_ERR,n.PARAM_ERR_MSG+t+"参数格式有误");return e.fail(a),e.complete(a),!0}return!1},checkKeyword:function(e){return!this.checkParamKeyEmpty(e,"keyword")},checkLocation:function(e){var t=this.getLocationParam(e.location);if(!t||!t.latitude||!t.longitude){var a=this.buildErrorConfig(n.PARAM_ERR,n.PARAM_ERR_MSG+" location参数格式有误");return e.fail(a),e.complete(a),!1}return!0},buildErrorConfig:function(e,t){return{status:e,message:t}},buildWxRequestConfig:function(e,t){var a=this;return t.header={"content-type":"application/json"},t.method="GET",t.success=function(t){var a=t.data;0===a.status?e.success(a):e.fail(a)},t.fail=function(t){t.statusCode=n.WX_ERR_CODE,e.fail(a.buildErrorConfig(n.WX_ERR_CODE,result.errMsg))},t.complete=function(t){var s=+t.statusCode;switch(s){case n.WX_ERR_CODE:e.complete(a.buildErrorConfig(n.WX_ERR_CODE,t.errMsg));break;case n.WX_OK_CODE:var o=t.data;0===o.status?e.complete(o):e.complete(a.buildErrorConfig(o.status,o.message));break;default:e.complete(a.buildErrorConfig(n.SYSTEM_ERR,n.SYSTEM_ERR_MSG))}},t},locationProcess:function(e,t,a,s){var o=this;if(a=a||function(t){t.statusCode=n.WX_ERR_CODE,e.fail(o.buildErrorConfig(n.WX_ERR_CODE,t.errMsg))},s=s||function(t){t.statusCode==n.WX_ERR_CODE&&e.complete(o.buildErrorConfig(n.WX_ERR_CODE,t.errMsg))},e.location){if(o.checkLocation(e)){var i=v.getLocationParam(e.location);t(i)}}else o.getWXLocation(t,a,s)}},m=function(){function e(t){if(o(this,e),!t.key)throw Error("key值不能为空");this.key=t.key}return s(e,[{key:"search",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),v.checkKeyword(e)){var a={keyword:e.keyword,orderby:e.orderby||"_distance",page_size:e.page_size||10,page_index:e.page_index||1,output:"json",key:t.key};e.address_format&&(a.address_format=e.address_format),e.filter&&(a.filter=e.filter);var s=e.distance||"1000",o=e.auto_extend||1,n=function(t){a.boundary="nearby("+t.latitude+","+t.longitude+","+s+","+o+")",wx.request(v.buildWxRequestConfig(e,{url:r,data:a}))};v.locationProcess(e,n)}}},{key:"getSuggestion",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),v.checkKeyword(e)){var a={keyword:e.keyword,region:e.region||"全国",region_fix:e.region_fix||0,policy:e.policy||0,output:"json",key:t.key};wx.request(v.buildWxRequestConfig(e,{url:d,data:a}))}}},{key:"reverseGeocoder",value:function(e){var t=this;e=e||{},v.polyfillParam(e);var a={coord_type:e.coord_type||5,get_poi:e.get_poi||0,output:"json",key:t.key};e.poi_options&&(a.poi_options=e.poi_options);var s=function(t){a.location=t.latitude+","+t.longitude,wx.request(v.buildWxRequestConfig(e,{url:c,data:a}))};v.locationProcess(e,s)}},{key:"geocoder",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),!v.checkParamKeyEmpty(e,"address")){var a={address:e.address,output:"json",key:t.key};wx.request(v.buildWxRequestConfig(e,{url:c,data:a}))}}},{key:"getCityList",value:function(e){var t=this;e=e||{},v.polyfillParam(e);var a={output:"json",key:t.key};wx.request(v.buildWxRequestConfig(e,{url:l,data:a}))}},{key:"getDistrictByCityId",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),!v.checkParamKeyEmpty(e,"id")){var a={id:e.id||"",output:"json",key:t.key};wx.request(v.buildWxRequestConfig(e,{url:u,data:a}))}}},{key:"calculateDistance",value:function(e){var t=this;if(e=e||{},v.polyfillParam(e),!v.checkParamKeyEmpty(e,"to")){var a={mode:e.mode||"walking",to:v.location2query(e.to),output:"json",key:t.key},s=function(t){a.from=t.latitude+","+t.longitude,wx.request(v.buildWxRequestConfig(e,{url:f,data:a}))};e.from&&(e.location=e.from),v.locationProcess(e,s)}}}]),e}();e.exports=m},d1e1:function(e,t,a){"use strict";a.r(t);var s=a("68e1"),o=a("54ec");for(var n in o)"default"!==n&&function(e){a.d(t,e,function(){return o[e]})}(n);a("6cb2");var i=a("2877"),r=Object(i["a"])(o["default"],s["a"],s["b"],!1,null,null,null);t["default"]=r.exports},f9d2:function(e,t,a){}},[["a32c","common/runtime","common/vendor"]]]);