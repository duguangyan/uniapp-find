(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/chatList/chatList"],{1470:function(t,e,a){"use strict";a.r(e);var i=a("67a9"),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);e["default"]=n.a},"46c5":function(t,e,a){"use strict";var i=a("cb0e"),n=a.n(i);n.a},"67a9":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{delBtnWidth:180,list:[{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018-09-22",txtStyle:""},{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018",txtStyle:""},{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018",txtStyle:""},{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018"},{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018"},{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018"},{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018"},{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018"},{img:"https://static.yidap.com/miniapp/o2o_find/index/index_banner_2.png",title:"小鹿小鹿",text:"快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑快跑",time:"2018"}],lists:[],startX:""}},onLoad:function(e){this.initEleWidth(),t.setStorageSync("chatListIds",[]),this.onSend()},mounted:function(){},onShow:function(){var t=this;this.globalData.callback=function(e){console.log("lists页面收到数据啦");var a=e;if(a&&a.length>0)t.$data.lists=a;else if(0!=a.fromUserId){var i=t.$data.lists.findIndex(function(t,e){return t.userInfoId=a.userInfoId});-1!=i?(t.$data.lists[i].userMessage=a,t.$data.lists[i].unRead++,t.$data.lists=t.$data.lists):t.onSend()}}},methods:{onSend:function(){var e=t.getStorageSync("userId"),a={fromUserId:e,toUserId:"",content:"page",smsType:"TEXT",sysType:1,smsStatus:10,smsList:!0,currentPage:"",pageSize:""};this.sendSocketMessage(JSON.stringify(a))},touchS:function(t){1==t.touches.length&&(this.$data.startX=t.touches[0].clientX)},touchM:function(t){if(1==t.touches.length){var e=t.touches[0].clientX,a=this.$data.startX-e,i=this.$data.delBtnWidth,n="";0==a||a<0?n="left:0px":a>0&&(n="left:-"+a+"px",a>=i&&(n="left:-"+i+"px"));var s=t.currentTarget.dataset.index,d=this.$data.list;d[s].txtStyle=n,this.$data.list=d}},touchE:function(t){if(1==t.changedTouches.length){var e=t.changedTouches[0].clientX,a=this.$data.startX-e,i=this.$data.delBtnWidth,n=a>i/2?"left:-"+i+"px":"left:0px",s=t.currentTarget.dataset.index,d=this.$data.list;d[s].txtStyle=n,this.$data.list=d}},getEleWidth:function(e){var a=0;try{var i=t.getSystemInfoSync().windowWidth,n=375/(e/2);return a=Math.floor(i/n),a}catch(s){return!1}},initEleWidth:function(){var t=this.getEleWidth(this.$data.delBtnWidth);this.$data.delBtnWidth=t},delItem:function(t){var e=t.currentTarget.dataset.index,a=this.$data.list;a.splice(e,1),this.$data.list=a},getCacheMessage:function(){var t=this;IMapi.getCacheMessage({data:{receiveUserId:1,sendUserId:2}}).then(function(e){t.$data.list=e.data})},goChat:function(e){var a=e.currentTarget.dataset.id,i=(e.currentTarget.dataset.index,e.currentTarget.dataset.photo),n=e.currentTarget.dataset.name,s=e.currentTarget.dataset.key;this.$data.lists[s].unRead=0,this.$data.lists=this.$data.lists;var d=t.getStorageSync("chatListIds")||[];d.length>0?d.forEach(function(t,e){t!=a&&d.push(a)}):d.push(a),t.setStorageSync("chatListIds",d),t.navigateTo({url:"/pages/chat/chat?toUserId="+a+"&fmUserName="+n+"&fromUserPhoto="+i+"&index="+s})}}};e.default=a}).call(this,a("6e42")["default"])},c0bf:function(t,e,a){"use strict";a.r(e);var i=a("e092"),n=a("1470");for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);a("46c5");var d=a("2877"),c=Object(d["a"])(n["default"],i["a"],i["b"],!1,null,"cb4880b6",null);e["default"]=c.exports},cb0e:function(t,e,a){},e092:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",[t.lists.length<=0?a("view",{staticClass:"no-data"},[t._v("暂无数据")]):t._e(),a("view",{staticClass:"chat-list"},[a("view",{staticClass:"items"},t._l(t.lists,function(e,i){return a("view",{key:i,staticClass:"item",attrs:{"data-key":i,"data-name":e.nickName||e.userName,"data-photo":e.avatarPath,"data-id":e.toUserId,eventid:"2c59a812-1-"+i},on:{tap:t.goChat}},[a("view",{staticClass:"inner txt cf",style:e.txtStyle,attrs:{"data-index":i}},[a("view",{staticClass:"fll item-1"},[a("image",{attrs:{src:e.avatarPath||"https://ossyidap.oss-cn-shenzhen.aliyuncs.com/image/png/9EAFE4BFEFDDF762718332C8F1BE9F2C.png"}}),e.unRead>0?a("view",{staticClass:"spot"}):t._e()]),a("view",{staticClass:"fll item-2"},[a("view",{staticClass:"nickName"},[t._v(t._s(e.nickName||e.userName))]),a("view",{staticClass:"ellipsis"},[t._v(t._s("TEXT"==e.userMessage.smsType?e.userMessage.content:"[图片]"))])]),a("view",{staticClass:"flr item-3"},[t._v(t._s(e.userMessage.dateTime))])]),a("view",{staticClass:"inner del",attrs:{"data-index":i,eventid:"2c59a812-0-"+i},on:{tap:t.delItem}},[t._v("删除")])])}))])])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},e538:function(t,e,a){"use strict";a("a3d9");var i=s(a("b0ce")),n=s(a("c0bf"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(n.default))}},[["e538","common/runtime","common/vendor"]]]);